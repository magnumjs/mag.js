/*
Mag.JS v0.27.6
http://github.com/magnumjs/mag.js
(c) Michael Glazer
License: MIT
*/
(function(b,c){'use strict';function g(P,Q){if(v[P]&&!Q)return v[P];var R=mag.doc.getElementById(P);return R&&(v[P]=R),v[P]}var h='KEY',j=0,l=['#'+h,'.'+h,h],n=function(P,Q){var R;for(var S in l){var T=l[S].replace(h,Q);if(R=P.querySelector(T),R)break}return R},q=function(P){var Q=mag.utils.items.getItemVal(P),R=mag.getNode(Q);return R},r=function(P){if('string'==typeof P){var Q=q(~mag.mod.runningViewInstance||mag.utils.runningEventInstance),R=n(Q||mag.doc,P);if(R)return R}return P},t=function(P,Q,R){var S=[],T=P.cloneNode(1),U=[],V=[],W=function(X){var Y=P;X=X||{};var Z=X.key+W.id,$=X.key?X.key+W.id:W.id;V[$]||(V[$]=mag.utils.copy(R)),'object'==typeof X&&(X=mag.utils.extend(V[$],X)),Z&&!S[Z]?Y=S[Z]=T.cloneNode(1):Z&&S[Z]&&(Y=S[Z]),Y[mag.MAGNUM]=Y[mag.MAGNUM]||{},Y[mag.MAGNUM].scid=$,mag._cprops[$]&&(X.children=mag._cprops[$]);var _=Q(X);return _!=U[$]&&(U[$]=_,mag.fill.run(Y,_)),Y};return W.id=++j,W};b.mag=function(P,Q,R){if(P=r(P),Q=r(Q),R=R||{},mag.utils.isHTMLEle(Q)&&mag.utils.isHTMLEle(P))Q[mag.MAGNUM]||mag.fill.run(Q,P);else{if('function'==typeof Q&&mag.utils.isHTMLEle(P)){try{t(P.cloneNode(1),Q,R)()}catch(S){}return t(P,Q,R)}return H(-1,g(mag._isNode(P)),Q,R)}},mag.MAGNUM='__magnum__',mag.rafBounceIds=[],mag._cprops=[],mag.doc=c;var u={values:[],attributes:[],elementMatcher:[]},v=[],j=0;mag._isNode=function(P){return mag.utils.isHTMLEle(P)&&(!P.id&&(P.id=++j),v[P.id]=P,P=P.id),P};var w=function(P,Q){var R,S=Q?P+'-'+Q:P;return R=mag.utils.items.isItem(S)?mag.utils.items.getItem(S):mag.utils.getItemInstanceId(S),R};mag.module=function(P,Q,R){R=R||{},P=mag._isNode(P);var S=w(P,R.key),T=x(R,S,Q,P);return T?H(S,T,Q,mag.utils.copy(R)):void 0};var x=function(P,Q,R,S){P.retain||mag.mod.clear(Q);var T=g(S);if(mag.mod.submodule(S,Q,R,P),I(Q,S),!N(Q,T))return mag.redraw(T,Q,1).then(function(){O(Q,T)}),T},y=function(P,Q){return 0>Q||Q!=mag.utils.items.getItem(P)?P==mag.mod.getId(Q):!0},z=[];mag.begin=function(P){'undefined'==typeof z[P]?z[P]=1:z[P]++},mag.end=function(P){if(1<z[P])z[P]--;else{z[P]=0;var Q=mag.utils.items.getItemVal(P);mag.redraw(g(Q),P)}},mag.redraw=function(P,Q,R){if(!z[Q]){if(!P||'undefined'==typeof Q)throw Error('Mag.JS - Id or node invalid: '+mag.utils.items.getItemVal(Q));if(!y(P.id,Q))return{then:S=>S()};if(R&&mag.fill.configs.splice(0,mag.fill.configs.length),R&&mag.mod.clear(Q),mag.mod.runningViewInstance==Q)throw Error('Mag.JS - recursive call: '+Q);return mag.utils.scheduleFlush(Q,J(P,Q,R))}},mag.hookin=function(P,Q,R){u[P].push({context:{},handler:R,key:Q})},mag.hook=function(P,Q,R){for(var S=0,T=u[P].length;S<T;S++)mag.utils.callHook(u,Q,P,S,R)};var A={},B=[],C=[],D=function(P,Q,R){var S=mag.getNode(mag.mod.getId(P)),T=function(){mag.utils.callLCEvent('onunload',mag.mod.getState(P),S,P)||(mag.clear(P),M(P,S),Q[P]&&(Q[P].length=0),R&&(mag.fill.removeNode(S),mag.mod.remove(P)))};mag.mod.getState(P).onbeforeunload?mag.utils.callLCEvent('onbeforeunload',mag.mod.getState(P),S,P,0,function(){T()}):T()},E=function(P,Q){C[P]=C[P]||[];var R=C[P].push(Q);return mag.utils.onLCEvent('didupdate',P,function(S,T){var U=mag.utils.merge(mag.utils.copy(T),mag.utils.copy(S));if(JSON.stringify(U)!==JSON.stringify(B[P])){for(var V of C[P])V(S,T,g(mag.mod.getId(P)),B[P]);B[P]=U}}),function(){return C[P].splice(R-1,1)}},F=[],G=function(P,Q,R,S,T){var U=mag.utils.items.getItem(Q);(O(U,P),!(mag.mod.exists(U)&&mag.utils.callLCEvent('willgetprops',mag.mod.getState(U),P,U,0,R)))&&(mag.mod.submodule(P.id,U,S,R),I(U,P.id),N(U,P)||mag.redraw(P,U,T).then(function(){O(U,P)}))},H=function(P,Q,R,S){F[P]=F[P]||[];var T=function(U,V,W,X,Y){'object'==typeof Y&&(X=mag.utils.merge(mag.utils.copy(X),Y),Y=0);var Z=V.id+(X.key?'.'+X.key:'')+'.'+(Y||0);!A[Z]||X.key||~T._id||(Z+=++j);var $=A[Z]=A[Z]||V.cloneNode(1);if($.id=Z,mag.utils.items.isItem(Z))return G($,Z,X,W,1),$;var _=mag.utils.getItemInstanceId($.id);return 0>U?U=T._id=_:F[U].push({instanceId:_,subscribe:E.bind({},_)}),G($,Z,X,W,1),$}.bind({},P,Q,R,S);return T._id=P,T.clones=function(){return F[T._id]},T.destroy=function(U){D(T._id,T.clones,U)},T.getId=function(){return T._id},T.rafBounce=function(U){return U?mag.rafBounceIds[T._id]=1:!1===U&&(mag.rafBounceIds[T._id]=0),!!mag.rafBounceIds[T._id]},T.draw=function(U){return mag.redraw(Q,T._id,U)},T.getState=function(){return mag.mod.getState(T._id)},T.getProps=function(){return mag.mod.getProps(T._id)},T.subscribe=function(U){return E(T._id,U)},T},I=function(P,Q){var R=function(S,T){g(T)?mag.redraw(g(T),S):mag.utils.items.isItem(T)&&mag.clear(S)}.bind({},P,Q);mag.mod.setFrameId(P,R)};mag.clear=function(P){mag.utils.items.removeItem(P),mag.mod.clear(P),mag.fill.clearCache(mag.mod.getId(P))};var J=function(P,Q,R){return function(S,T,U){if(g(S.id,1),y(S.id,T)&&S){var V=mag.mod.getState(T);return mag.utils.callLCEvent('isupdate',V,S,T)?void 0:mag.mod.iscached(T)&&!U?0:void(mag.utils.callLCEvent('willupdate',V,S,T)||(mag.mod.callView(S,T),mag.fill.setId(S.id),mag.fill.run(S,V),mag.fill.setId(0),K(S.id,mag.fill.configs),mag.utils.callLCEvent('didupdate',V,S,T),!U&&mag.mod.iscached(T)))}}.bind({},P,Q,R)},K=function(P,Q){for(var R in Q)R.startsWith('id("'+P+'")/')&&Q[R]()},L=function(P){var R=[];for(var S in mag.fill.cached)-1<S.indexOf('id("'+P+'")/')&&-1<S.indexOf('-config')&&mag.fill.cached[S].configContext&&R.push({path:S.split('-config')[0],controller:mag.fill.cached[S].configContext,handler:mag.fill.cached[S].configContext.onunload});return R},M=function(P,Q){for(var T,R=L(Q.id,P),S=0,U=R;T=U&&U[S];S++)T.controller.onunload&&(T.handler.call(T.controller,Q,T.path),T.controller.onunload=0)},N=function(P,Q){return mag.utils.callLCEvent('willload',mag.mod.getState(P),Q,P,1)},O=function(P,Q){var R=mag.utils.items.getItemVal(P);if(g(R))return mag.utils.callLCEvent('didload',mag.mod.getState(P),Q,P,1)};mag.getNode=g})(window||global||this,document),function(b){'use strict';function c(t,u){var v=t.name;if('undefined'==typeof t.object[t.name]&&'_'!==v[0]){var w=b.fill.find(u,v),x='$'===v[0],y=[];return w.length?(w.forEach(function(z){var A;if(!(z&&z.type&&!~['submit','button'].indexOf(z.type)))'undefined'==typeof t.oldValue&&'undefined'==typeof t.object[t.name]&&z&&!~['submit','button'].indexOf(z.type)&&1==z.childNodes.length&&z.childNodes[0].textContent.trim()&&(A={_text:z.childNodes[0].textContent.trim()});else if(z.value&&0<z.value.length)if('checkbox'!=z.type&&'radio'!=z.type)A={_value:z.value};else if(z.checked&&(A={},A._checked=!0),!x){var B=u.querySelectorAll('[name='+z.name+']');if(B.length)for(var C of B)C.checked&&(A?A._value=C.value:A={_value:C.value})}else A?A._value=z.value:A={_value:z.value};A?y.push(A):z&&!z.hasChildNodes()&&y.push(h)}),0===y.length?void 0:x?y:y[0]&&'undefined'!=typeof y[0]._value?y[0]._value:y[0]&&y[0]._text?y[0]._text:y[0]):h}}function f(t,u){l.setProps(u,b.proxy(l.getProps(u),r.bind({},'props',u),'prop'));var w=new t(b.proxy({},r.bind({},'state',u)));return w}var g=[],h=b.MAGNUM,l={runningViewInstance:-1,innerMods:[],cache:[]};l.getState=function(t){return g[t][1]},l.setState=function(t,u){g[t][1]=u},l.getView=function(t){return g[t][0]},l.getProps=function(t){return g[t][2]},l.setProps=function(t,u){return g[t][2]=u},l.remove=function(t){g.splice(t,1)},l.getId=function(t){return g[t]&&g[t][3]},l.exists=function(t){return'undefined'!=typeof g[t]},l.setFrameId=function(t,u){g[t][4]=u},l.getFrameId=function(t){return g[t][4]},l.getMod=function(t){return g[t][5]},l.submodule=function(t,u,v,w){if(v=b.utils.copy(v),g[u])return w.key&&w.key===l.getProps(u).key?l.setProps(u,b.utils.copy(b.utils.merge(l.getProps(u),w))):l.setProps(u,w),g[u];g[u]=[0,0,0,0,0,0],l.setProps(u,w);var y=function(A,B,C){v.element=C,v.state=B,v.props=l.getProps(A),v.view&&v.view.call(v,B,v.props,C)}.bind({},u),z={controller:function(A){return v.props=l.getProps(u),v.state=A,v.element=b.getNode(t),(v.controller||function(){}).call(A,v.props)||A},view:y};return g[u][0]=z.view,g[u][3]=t,g[u][1]=f(z.controller,u,t),g[u][5]=v,g[u]};var n=[],q=function(t,u){var v=t,w=u.split('/');for(var x of w)if(x){var y=b.fill.find(v,x);y.length&&(v=y[0])}return v},r=function(t,u,v){if('get'==v.type&&'props'!=t&&!~b.fill.ignorekeys.indexOf(v.name.toString())&&'undefined'==typeof v.oldValue){var w=b.doc.getElementById(l.getId(u));if(v.path&&'/'==v.path[0])var x=q(w,v.path);var y=c(v,x?x:w);if('undefined'!=typeof y&&'object'==typeof y&&v.object&&b.utils.merge(y,v.object[v.name]),'undefined'!=typeof y)return l.cached[u]=0,y}else'set'==v.type&&'props'!=t&&v.object[v.name]&&v.object[v.name].draw&&'function'==typeof v.object[v.name].draw&&(l.innerMods[l.getId(u)]=[v.name,v.object[v.name]]);var z=l.getFrameId(u);'function'==typeof z&&'set'==v.type&&(cancelAnimationFrame(n[u]),n[u]=requestAnimationFrame(z))};l.iscached=function(t){var u=JSON.stringify(b.utils.merge(b.utils.copy(l.getProps(t)),l.getState(t)));return t in l.cache&&l.cache[t]==u||void(l.cache[t]=u)},l.remove=function(t){g[t]&&(g[t]=0)},l.clear=function(t){~t&&l.cache[t]&&l.cache.splice(t,1)},l.cached=[],l.callView=function(t,u){l.runningViewInstance=u,l.cached[u]||(b.props.attachToArgs(u,l.getState(u),t),l.cached[u]=1);try{l.getView(u)(l.getState(u),t)}finally{l.runningViewInstance=-1}},b.mod=l}(mag),function(b){'use strict';function f(v,w,x,y){var z=[];for(var A in v){var B=v[A];h(B)&&(z.push(B),g(B,w,x,y))}return!!z.length&&(1==z.length?z[0]:z)}function g(v,w,x,y){if(v[n]=v[n]||{},!v[n].eventOnFocus){var z=function(A,B,C){var E=~['radio','checkbox'].indexOf(v.type);this[n].dirty||(this[n].dirty=1),E?'_checked'in B||'_value'in B?B._checked=this.checked:this.checked&&(B[C]=this.value):void 0===B._value?void 0!==B._text&&(B._text=this.value):B._value=this.value,b.redraw(A,b.utils.items.getItem(A.id))}.bind(v,y,w,x);v.addEventListener('click',z,!1),v.addEventListener('input',z,!1),v.addEventListener('focus',z,!1),v[n].eventOnFocus=1}}function h(v){return v&&~['INPUT','SELECT','TEXTAREA'].indexOf(v.tagName)}function j(v){for(var w in v)if(h(v[w]))return v[w];return!1}var l={},n=b.MAGNUM,q=function(v,w){for(var x=1;x<v.length;x++){var y=v[x],z=v[x+1],A=b.fill.find(Array.isArray(w)?w[0]:w,y);if(z&&!isNaN(+z))w=A[z];else if(A&&A.length&&z&&x+2<v.length)w=b.fill.find(A[0],z);else if(A&&A.length&&(w=A,x+2==v.length))break}return Array.isArray(w)?w[0]:w},r=function(v,w,x,y){var A,z=x.toString().split('.');if(3<=z.length)y=q(z,y),A=b.fill.find(y,w);else{var B=parseInt(z.pop()),C=isNaN(B)?0:B;A=b.fill.find(y[C]?y[C]:y,w)}return f(A,v,w,y)},t=function(v,w,x,y){var z=x[w];~['_value','_checked','_text'].indexOf(w)&&(w=v.split('.').pop());var A=b.fill.find(y,w),B=j(A);if('function'!=typeof z&&B){var C=r.bind({},x,w,v,y);C(),Object.defineProperty(x,w,{configurable:!0,get:function(){var D=C();return D&&'undefined'!==D.value&&D[n]&&D[n].dirty&&D.value!==z?(z=D.value,b.redraw(y,v,1),D.value):z},set:function(D){var E=C();E&&'undefined'!==E.value&&E.value!==D&&D!==z&&(E.value=D,z=D)}})}},u=function(v,w,x){for(var y in w)if(w.hasOwnProperty(y)){var z=w[y];'object'!=typeof z||b.utils.isHTMLEle(z)?t.bind({},v,y,w,x)():(b.utils.isObject(z)&&b.utils.isEmpty(z)&&(z._value=''),u(v+'.'+y,z,x))}};l.attachToArgs=u,b.props=l}(mag),function(b){'use strict';var c={isObject:function(l){return'Object]'==Object.prototype.toString.call(l).substr(-7)},isEmpty:function(l){for(var n in l)if(l.hasOwnProperty(n))return 0;return 1},isHTMLEle:function(l){return l&&1===l.nodeType},callHook:function(l,n,q,r,t,u){l[q][r].key==n&&(u={v:t.value,k:t.key},t.change=!1,l[q][r].handler.call(l[q][r].context,t),{v:t.value,k:t.key}!==u&&(t.change=!0))}},f=[],g=[];c.scheduleFlush=function(l,n){return new Promise(function(q){b.rafBounce||b.rafBounceIds[l]?(cancelAnimationFrame(g[l]),g[l]=requestAnimationFrame(function(){n(),q(),g[l]=0})):(f.push(n),g[l]?q():g[l]=requestAnimationFrame(function(){g[l]=0;for(var r;r=f.shift();)r();q()}))})};var h=[];c.onLCEvent=function(l,n,q){var r=l+'-'+n;h[r]=h[r]||[];var t=h[r].push(q);return function(){return h[r].splice(t-1,1)}},c.callLCEvent=function(l,n,q,r,t,u){var v;c.runningEventInstance=r;var w=b.mod.getProps(r);n&&n[l]&&(v=n[l].call(b.mod.getMod(r),q,w,r,u),t&&(n[l]=0));var x=l+'-'+r;if(h[x]){for(var y of h[x])y(n,w);t&&(h[x]=0)}return(c.runningEventInstance=-1,!1===v)||void 0},c.copy=function(l){return Object.assign({},l)},c.merge=function(){return Object.assign.apply({},arguments)},c.extend=function(l,n,q){for(var r in n)if(n[r]===void 0)delete n[r];else if(q&&c.isObject(n[r]))return c.extend(l[r],n[r]);return c.merge(l,n)};var j={i:[],isItem:function(l){return~j.i.indexOf(l)},setItem:function(l){j.i[j.i.length]=l},getItem:function(l){return j.i.indexOf(l)},getItemVal:function(l){return j.i[l]},removeItem:function(l){j.i.splice(j.i.indexOf(l),1)}};c.items=j,c.getItemInstanceIdAll=function(){return j.i},c.getItemInstanceId=function(l){return j.isItem(l)?j.getItem(l):(j.setItem(l),j.getItem(l))},b.utils=c}(mag),function(b,c,f){'use strict';function g(aa){return Array.isArray(aa)}function h(aa,ba){return aa[R]=aa[R]||{},(!aa[R].uid||ba)&&(aa[R].uid=++Y),aa[R].uid}function j(aa,ba){var ca=h(aa,ba);return V[ca]?V[ca]:V[ca]=q(aa)}function l(aa,ba,ca){var da=h(aa,ca);return W[P.id]=W[P.id]||[],W[P.id][da]&&W[P.id][da]==ba?1:void(W[P.id][da]=ba)}function n(aa){return aa.id?aa:aa.parentNode?n(aa.parentNode):void 0}function q(aa){var ba='',ca=n(aa),da=aa.parentNode&&[].indexOf.call(aa.parentNode.children,aa);return ca&&(ba+='id("'+ca.id+'")'),ba+='/'+aa.tagName+'['+(da+1)+']',ba}function r(aa){if(aa.id&&P.id===aa.id)return'id("'+aa.id+'")';if(aa===b.doc.body)return aa.tagName;var ba=0;if(aa.parentNode)for(var ea,ca=aa.parentNode.childNodes,da=0;da<ca.length;da++){if(ea=ca[da],ea===aa)return r(aa.parentNode)+(aa.tagName?'/'+aa.tagName+'['+(ba+1)+']':'');1===ea.nodeType&&ea.tagName===aa.tagName&&ba++}}function t(aa){var ba=r(aa);aa&&Q[ba+'-config']&&Q[ba+'-config'].configContext&&typeof Q[ba+'-config'].configContext.onunload==='function'&&(Q[ba+'-config'].configContext.onunload(Q[ba+'-config'].configContext,aa,ba),delete Q[ba+'-config'],delete P.configs[ba]),aa.parentNode&&aa.parentNode.removeChild(aa),b.mod.cached[b.utils.items.getItem(P.id)]=0}function u(aa){var ba=aa&&parseInt(aa.split('[').pop().slice(0,-1));return ba?parseInt(ba)-1:0}function v(aa){return aa&&~aa.indexOf('id(')&&aa.split('id("')[1].split('")')[0]}function w(aa){if(aa&&aa[R]&&aa[R].isChildOfArray)return aa;return aa.parentNode?w(aa.parentNode):void 0}function x(aa,ba,ca){if(!l(aa,ba.outerHTML,ca)&&(!ba.id&&!aa.childNodes[0]||ba.id&&!b.doc.getElementById(ba.id)||aa.firstChild&&!aa.firstChild.isEqualNode(ba))){var da=b.utils.items.getItem(ba.id);if(~da&&aa.hasChildNodes()){var ea=b.utils.items.getItem(P.id),fa=aa.cloneNode(1);fa[R]={childof:ea},b.mod.getProps(da).children=fa}else if(ba[R]&&ba[R].scid){var fa=aa.cloneNode(1);fa[R]={childof:ba[R].scid},b._cprops[ba[R].scid]=fa}for(;aa.lastChild;)aa.removeChild(aa.lastChild);if(ba[R]&&ba[R].childof!==f){aa.innerHTML=ba.innerHTML;var ga=b.utils.items.getItem(P.id),ha=ba[R].childof;~ga&&!L(ga,ha)&&(b.utils.onLCEvent('willupdate',ba[R].childof,function(){b.utils.merge(b.mod.getState(ga),b.mod.getState(ha))}),Z.push(ga+','+ha),Z.push(ha+','+ga))}else aa.appendChild(ba)}}function y(aa,ba){var ca;for(var da in ba){var ea=ba[da];ea===f?ea='':null===ea&&-1===['onunload'].indexOf(da)?(aa[R].detached=aa[R].detached||[],aa[R].detached[da]=1,C(aa,da)):aa[R].detached&&aa[R].detached[da]&&(B(aa,da),aa[R].detached[da]=0),'_'===da[0]&&'_'!==da[1]&&(ca=ca||{},ca[da.substr(1)]=ea)}return ca}function z(aa,ba,ca){var da;for(var ea in ba){var fa=ba[ea];if(!~P.ignorekeys.indexOf(ea)&&'_'!==ea[0]){da=K(aa,ea);var ga={key:ea,value:fa,node:aa};b.hook('values','*',ga),ga.change&&(fa=ga.value),g(fa)&&(da=K(aa,'$'+ea)),P.run(da,fa,ca+'/'+ea)}}}function A(aa,ba,ca,da){var ea,ia=u(ca);return ba&&b.utils.isHTMLEle(ba)?void x(aa,ba):'function'==typeof ba?$(ba,aa,ia,ca):'object'==typeof ba?void(b.mod.innerMods[P.id]&&ba[b.mod.innerMods[P.id][0]]&&!ba[b.mod.innerMods[P.id][0]].draw&&b.mod.innerMods[P.id][1].destroy(),ea=y(aa,ba),ea&&H(aa,ea,ca,da),z(aa,ba,ca)):A(aa,{_text:ba},ca)}function B(aa,ba){var ca=K(aa,ba);ca.forEach(function(da){var ea=h(da);if(ea in _){for(var fa in _[ea])da.appendChild(_[ea][fa]);delete _[ea]}})}function C(aa,ba){var ca=0,da=1,ea=function(ha){if(++ca==da)for(;ha.lastChild;)t(ha.lastChild)},fa=function(ha,ia){var ja;ha.id&&b.utils.items.isItem(ha.id)&&(ja=b.utils.items.getItem(ha.id)),ja&&b.mod.getState(ja).onbeforeunload?(da++,b.utils.callLCEvent('onbeforeunload',b.mod.getState(ja),ha,ja,0,function(){ja&&b.utils.callLCEvent('onunload',b.mod.getState(ja),ha,ja),ia()})):(ja&&b.utils.callLCEvent('onunload',b.mod.getState(ja),ha,ja),ia())},ga=K(aa,ba);ga.forEach(function(ha){var ia=h(ha);ha.children.length&&(_[ia]=D(ha.children));for(var ka in _[ia]){var la=_[ia][ka];fa(la,function(){ea(ha)})}ea(ha)})}function D(aa){var ba;if(null==aa.length&&(aa=[aa]),!g(aa)){ba=[];for(var ca=0;ca<aa.length;ca+=1)aa[ca]&&ba.push(aa[ca]);aa=ba}return aa}function E(aa,ba){var ca=function(da,ea,fa){var ga=w(ea),ha=ga&&r(ga),ia=u(ha),ja=q(ea),ka=u(ja),la={path:ha,data:((ga||{})[R]||[]).dataPass,node:ga,index:ia},ma=v(ja),na=b.doc.getElementById(ma),oa=b.utils.items.getItem(ma),pa=da.call(~oa?b.mod.getMod(oa):na,fa,ka,ea,la);if(ma&&na){var qa=function(){b.redraw(na,oa,1)};pa&&pa.then?pa.then(function(ra){return qa(),ra}):qa()}return pa}.bind({},ba,aa);return ca}function F(aa,ba,ca){aa.removeEventListener(ba,ca),aa.addEventListener(ba,ca)}function G(aa,ba,ca,da){var ea=ba.substr(2).toLowerCase(),fa=ca[R].events=ca[R].events||[],ga=ea+(da?da.split(')').pop():'')+ca[R].uid;(!fa[ga]||fa[ga]&&''+fa[ga]!=''+aa)&&(fa[ga]=aa,F(ca,ea,E(ca,aa)))}function H(aa,ba,ca,da){var ea=u(ca);for(var fa in Q[h(aa)]=Q[h(aa)]||[],ba)if('text'!==fa&&'html'!==fa)if(0==fa.indexOf('on'))G(ba[fa],fa,aa,da);else{if('config'==fa){var ca=r(aa),ea=u(ca),ga=!0;Q[ca+'-config']?ga=!1:Q[ca+'-config']={};var ha=Q[ca+'-config'].configContext=Q[ca+'-config'].configContext||{},ia=function(ma,na){return function(){return ma.apply(ma,na)}};c[ca]=ia(ba[fa],[aa,ga,ha,ea]);continue}var ja={key:fa,value:ba[fa],node:aa};if(b.hook('attributes',fa,ja),ja.change&&(fa=ja.key,ba[fa]=ja.value),Q[h(aa)]&&Q[h(aa)][fa]==ba[fa])continue;null===ba[fa]?aa.removeAttribute(fa):fa in aa?'style'==fa?aa[fa].cssText=ba[fa]:aa[fa]=ba[fa]:aa.setAttribute(fa,ba[fa]+''),Q[h(aa)][fa]=ba[fa]}I(aa,ba.text),J(aa,ba.html)}function I(aa,ba){if(aa&&null!=ba&&!l(aa,ba)){var ca=ba+'';if('INPUT'!==aa.nodeName)'SELECT'!==aa.nodeName&&(aa.firstChild?aa.firstChild.textContent=ca:aa.appendChild(aa.ownerDocument.createTextNode(ca)));else if(!~['radio','checkbox'].indexOf(aa.type))ca!=aa.value&&(aa.value=ca);else if(aa.name){var da=b.getNode(P.id).querySelectorAll('[name='+aa.name+']');if(1<da.length)for(var ea of da)if(ea.value==ca){ea.checked=!0;break}}'SELECT'===aa.nodeName&&ca&&(aa.value=ca)}}function J(aa,ba){!aa||null==ba||l(aa,ba)||(aa.innerHTML=b.utils.isHTMLEle(ba)?ba.innerHTML:ba)}function K(aa,ba,ca){var da=N(aa),ea=[],fa=ba,ga='$'===ba[0];'$'===fa[0]&&(fa=fa.substr(1));for(var ha=0;ha<da.length;ha+=1)O(da[ha],fa)&&ea.push(da[ha]);if(!ea.length||ga)for(var ha=0;ha<da.length&&(ea=ea.concat(K(da[ha],ba,!0)),!ea.length||ga);ha++);if(!ca&&!ea.length){var ia={key:ba,value:ea,node:aa};b.hook('elementMatcher',ba,ia),ia.change&&(ea=ia.value)}return ea}function L(aa,ba){return~Z.indexOf(aa+','+ba)}function M(aa){return P.id&&aa.id&&aa.id!=P.id&&b.utils.items.isItem(aa.id)&&!L(b.utils.items.getItem(P.id),b.utils.items.getItem(aa.id))?0:1}function N(aa){var ba=[];if(aa){var ca=aa.childNodes;if(ca)for(var da=0;da<ca.length;da+=1)1===ca[da].nodeType&&M(ca[da])&&ba.push(ca[da])}return ba}function O(aa,ba){var ca=' '+aa.className+' ';return aa.id===ba||~ca.indexOf(' '+ba+' ')||aa.name===ba||aa.nodeName.toLowerCase()===ba.toLowerCase()||aa.getAttribute('data-bind')===ba}var P={cached:[],ignorekeys:['toString','draw','then','hasOwnProperty','willgetprops','onbeforeunload','Symbol(Symbol.toStringTag)','nodeType','toJSON','onunload','willupdate','didupdate','didload','willload','isupdate']},Q=P.cached,R=b.MAGNUM,T='undefined',U='_key',V=[],W=[],X={},Y=0;P.run=function(aa,ba,ca){var da,ea;if(aa){null==ba&&(ba={_text:''});var fa=D(aa);if(ea=g(ba),ea){if(X[ca]&&0===fa.length&&(X[ca].parent.insertAdjacentHTML('beforeend',X[ca].node),fa=D(X[ca].parent.children)),!fa.length)return;var ga=fa[0].parentNode;for(X[ca]||(X[ca]={node:fa[0].cloneNode(1).outerHTML,parent:ga});fa.length<ba.length;)X[ca]?(ga.insertAdjacentHTML('beforeend',X[ca].node),da=ga.lastChild):da=fa[0].cloneNode(1),fa.push(da),ga&&ga.appendChild(da);var ha=ba.map(function(ma){return ma&&ma[U]});if((fa.length==ba.length||-1!==ha.indexOf(f))&&(ba=ba.map(function(ma,na){if('object'==typeof ma){if(fa[na][R]=fa[na][R]||{},fa[na][R].__key&&typeof ma[U]==T)return ma[U]=fa[na][R].__key,ma;typeof ma[U]==T&&(ma[U]=R+na),fa[na][R].__key=ma[U]}return ma})),fa.length>ba.length)if(0===ba.length||'object'!=typeof ba[0])for(;fa.length>ba.length;)da=fa.pop(),ga=da.parentNode,ga&&t(da);else{var ia=[],ja=ba.map(function(ma){return ma[U]});fa=fa.filter(function(ma){var oa;return(typeof ma[R]==T?oa=1:(!~ja.indexOf(ma[R].__key)||~ia.indexOf(ma[R].__key))&&(ia.push(ma[R].__key),oa=1),oa)?(t(ma),!1):(ia.push(ma[R].__key),!0)})}}for(var ka=0;ka<fa.length;ka++)if(ea)fa[ka]&&P.run(fa[ka],ba[ka]);else{var la=j(fa[ka]);ba&&'object'==typeof ba&&(fa[ka][R]=fa[ka][R]||{},ba[U]!==f&&(fa[ka][R].isChildOfArray=!0,fa[ka][R].dataPass=ba[R]),fa[ka][R].xpath=la),A(fa[ka],ba,la,ca)}}};var Z=[],$=function(aa,ba,ca,da){var ea=w(ba.parentNode),fa=ea&&ea.getAttribute('key');ea&&fa&&(ca=+fa.split(R)[1]);var ga=aa(ca);if(ga&&b.utils.isHTMLEle(ga))return x(ba,ga),ba[R]=ba[R]||{},ba[R].isChildOfArray=!0,ba[R].dataPass={index:ca},void(aa.draw&&aa.draw());var ha=/<[a-z][\s\S]*>/i.test(ga)?'_html':'_text',ia={};return ia[ha]=ga,A(ba,ia,da)},_=[];P.removeNode=t,P.configs=c,P.find=K,P.setId=aa=>{P.id=aa},P.clearCache=aa=>{W[aa]&&delete W[aa]},b.fill=P}(mag,[]),function(b){function f(h,j,l,n){function q(t){return r.has(t)}var r=new WeakSet;return new Proxy(h,{get:function(t,u,v){var w=t[u];if('symbol'==typeof u)return w;if('object'!=typeof w||'symbol'==typeof w||null===w||'function'==typeof w||Array.isArray(w)||!b.utils.isObject(w)||w.then||w.draw)u in t||~b.fill.ignorekeys.indexOf(u.toString())||l||'_'==u[0]||(w=b.proxy({},j,l,n+g+u));else if(!q(w))return r.add(w),b.proxy(w,j,l,n+g+u);var x=j({type:'get',object:t,name:u,path:n,oldValue:Reflect.get(t,u,v)});return'undefined'!=typeof x&&(w=x==b.MAGNUM?void 0:x),w},deleteProperty:function(t,u){return j({type:'delete',name:u,object:t,oldValue:Reflect.get(t,u)}),Reflect.deleteProperty(t,u)},set:function(t,u,v,w){var x=Reflect.get(t,u,w);return x===v&&'length'!==u||(j({type:'set',name:u,object:t,oldValue:x}),Reflect.set(t,u,v,w))}})}var g='/';b.proxy=function(h,j,l,n){for(var q in h){var r=typeof h[q];Array.isArray(h[q])&&101>h[q].length?h[q]=f(h[q],j):'object'==r&&null!==h[q]&&'symbol'!=typeof q&&'symbol'!=r&&'function'!=r&&b.utils.isObject(h[q])&&(h[q]=b.proxy(h[q],j,l,n+g+q))}return f(h,j,l,n||g)}}(mag,window||global||this);
