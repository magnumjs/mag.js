/*
Mag.JS v0.29.5
http://github.com/magnumjs/mag.js
(c) Michael Glazer
License: MIT
*/
(function(b,f){'use strict';function h(S,T){if(y[S]&&!T)return y[S];var U=mag.doc.getElementById(S);return U&&(y[S]=U),y[S]}var j='KEY',l=0,n=['#'+j,'.'+j,j],o=function(S,T){var U;for(var V in n){var W=n[V].replace(j,T);if(U=S.querySelector(W),U)break}return U},q=function(S){var T=mag.utils.items.getItemVal(S),U=mag.getNode(T);return U},r=function(S){if('string'==typeof S){var T=q(~mag.mod.runningViewInstance||mag.utils.runningEventInstance),U=o(T||mag.doc,S);if(U)return U}return S},t=function(S,T,U){var Z,V=[],W=S.cloneNode(1),Y=[],$=[],_=function(aa){var ba=S;aa=aa||{};var ca;aa.key&&(ca=aa.key+'-'+_.id);var da=aa.key?aa.key+'-'+_.id:_.id;if($[da]||($[da]='object'==typeof U?mag.utils.copy(U):U),'object'==typeof aa&&(aa=mag.utils.extend($[da],aa)),ca&&!V[ca]?ba=V[ca]=W.cloneNode(1):ca&&V[ca]&&(ba=V[ca]),Z&&Z==ba[u].scid)throw Error('MagJS Error - recursive call:'+Z);ba[u]=ba[u]||{},mag._cprops[da]&&'object'==typeof aa&&(aa.children=mag._cprops[da]),_.props=aa,_.key=ca;var ea;if(Y[da]!=mag.utils.toJson(aa))try{ea=T(aa),Z=ba[u].scid=da,Y[da]=mag.utils.toJson(aa);var fa=mag.fill.id;fa&&fa[u]&&fa[u].scid&&(ba[u].pscid=fa[u].scid),mag.fill.setId(ba),mag.fill.run(ba,ea)}finally{mag.fill.setId(fa),Z=0}return ba};return _.id=++l,_.element=W,_};b.mag=function(S,T,U){if(S=r(S),T=r(T),U=U||{},mag.utils.isHTMLEle(T)&&mag.utils.isHTMLEle(S))T[u]||mag.fill.run(T,S);else{if('function'==typeof T&&mag.utils.isHTMLEle(S)){try{t(S.cloneNode(1),T,U)()}catch(V){}return t(S,T,U)}return K(-1,h(mag._isNode(S)),T,U)}};var u='__magnum__';mag.MAGNUM=u,mag.rafBounceIds=[],mag._cprops=[],mag.doc=f;var w={values:[],attributes:[],elementMatcher:[]},y=[],l=0;mag._isNode=function(S){return mag.utils.isHTMLEle(S)&&(!S.id&&(S.id=++l),y[S.id]=S,S=S.id),S};var z=function(S,T){var U,V=T?S+'-'+T:S;return U=mag.utils.items.isItem(V)?mag.utils.items.getItem(V):mag.utils.getItemInstanceId(V),U};mag.module=function(S,T,U){U=U||{},S=mag._isNode(S);var V=z(S,U.key),W=A(U,V,T,S);return W?K(V,W,T,mag.utils.copy(U)):void 0};var A=function(S,T,U,V){S.retain||mag.mod.clear(T);var W=h(V);if(mag.mod.submodule(V,T,U,S),L(T,V),!Q(T,W))return mag.redraw(W,T,1).then(function(){R(T,W)}),W},B=function(S,T){return 0>T||T!=mag.utils.items.getItem(S)?S==mag.mod.getId(T):!0},C=[];mag.begin=function(S){'undefined'==typeof C[S]?C[S]=1:C[S]++},mag.end=function(S){if(1<C[S])C[S]--;else{C[S]=0;var T=mag.utils.items.getItemVal(S);mag.redraw(h(T),S)}},mag.redraw=function(S,T,U){if(!C[T]){if(!S||'undefined'==typeof T)throw Error('Mag.JS - Id or node invalid: '+mag.utils.items.getItemVal(T));if(!B(S.id,T))return{then:V=>V()};if(U&&mag.fill.configs.splice(0,mag.fill.configs.length),U&&mag.mod.clear(T),mag.mod.runningViewInstance==T)throw Error('Mag.JS - recursive call:'+T);return mag.utils.scheduleFlush(T,M(S,T,U))}},mag.hookin=function(S,T,U){w[S].push({context:{},handler:U,key:T})},mag.hook=function(S,T,U){for(var V=0,W=w[S].length;V<W;V++)mag.utils.callHook(w,T,S,V,U)};var D={},E=[],F=[],G=function(S,T,U){var V=mag.getNode(mag.mod.getId(S)),W=function(){mag.utils.callLCEvent('onunload',mag.mod.getState(S),V,S)||(mag.clear(S),P(S,V),T[S]&&(T[S].length=0),U&&(mag.fill.removeNode(V),mag.mod.remove(S)))};mag.mod.getState(S).onbeforeunload?mag.utils.callLCEvent('onbeforeunload',mag.mod.getState(S),V,S,0,function(){W()}):W()},H=function(S,T){F[S]=F[S]||[];var U=F[S].push(T);return mag.utils.onLCEvent('didupdate',S,function(V,W){var X=mag.utils.toJson([W,V]);if(X!=E[S])for(var Y of F[S])Y(V,W,h(mag.mod.getId(S)),JSON.parse(E[S]||'[]'));E[S]=X}),function(){return F[S].splice(U-1,1)}},I=[],J=function(S,T,U,V,W){var X=mag.utils.items.getItem(T);T=mag._isNode(S);var Y=mag.utils.toJson(mag.mod.getProps(X));(R(X,S),!(mag.mod.exists(X)&&mag.utils.callLCEvent('willgetprops',mag.mod.getState(X),S,X,0,U)))&&(mag.mod.submodule(S.id,X,V,U),Y!=mag.utils.toJson(mag.mod.getProps(X))&&(W=1),L(X,S.id),Q(X,S)||mag.redraw(S,X,W).then(function(){R(X,S)}))},K=function(S,T,U,V){I[S]=I[S]||[];var W=function(X,Y,Z,$,_){'object'==typeof _&&($=mag.utils.merge(mag.utils.copy($),_),_=0),0>X&&!_&&(_=1);var aa=Y.id+($.key?'.'+$.key+'.':'')+(_||'');!D[aa]||$.key||~W._id||(aa+=++l);var ba=D[aa]=D[aa]||Y.cloneNode(1);if(ba.id=aa,mag.utils.items.isItem(aa))return J(ba,aa,$,Z),ba;var ca=mag.utils.getItemInstanceId(ba.id);return 0>X?X=W._id=ca:I[X].push({instanceId:ca,subscribe:H.bind({},ca)}),J(ba,aa,$,Z),ba}.bind({},S,T,U,V);return W._id=S,W.clones=function(){return I[W._id]},W.destroy=function(X){G(W._id,W.clones,X)},W.getId=function(){return W._id},W.rafBounce=function(X){return X?mag.rafBounceIds[W._id]=1:!1===X&&(mag.rafBounceIds[W._id]=0),!!mag.rafBounceIds[W._id]},W.draw=function(X){return mag.redraw(T,W._id,X)},W.getState=function(){return mag.mod.getState(W._id)},W.getProps=function(){return mag.mod.getProps(W._id)},W.subscribe=function(X){return H(W._id,X)},W},L=function(S,T){var U=function(V,W){h(W)?mag.redraw(h(W),V):mag.utils.items.isItem(W)&&mag.clear(V)}.bind({},S,T);mag.mod.setFrameId(S,U)};mag.clear=function(S){mag.utils.items.removeItem(S),mag.mod.clear(S),mag.fill.clearCache(mag.mod.getId(S))};var M=function(S,T,U){return function(V,W,X){if(h(V.id,1),B(V.id,W)&&V){var Y=mag.mod.getState(W);if(!mag.utils.callLCEvent('isupdate',Y,V,W)){if(mag.mod.iscached(W)&&!X)return 0;if(!mag.utils.callLCEvent('willupdate',Y,V,W)){mag.mod.callView(V,W);var Z=mag.fill.id;mag.fill.setId(V.id),mag.fill.run(V,Y),mag.fill.setId(Z),N(V.id,mag.fill.configs),mag.utils.callLCEvent('didupdate',Y,V,W),X||mag.mod.iscached(W)}}}}.bind({},S,T,U)},N=function(S,T){for(var U in T)U.startsWith('id("'+S+'")/')&&T[U]()},O=function(S){var U=[];for(var V in mag.fill.cached)-1<V.indexOf('id("'+S+'")/')&&-1<V.indexOf('-config')&&mag.fill.cached[V].configContext&&U.push({path:V.split('-config')[0],controller:mag.fill.cached[V].configContext,handler:mag.fill.cached[V].configContext.onunload});return U},P=function(S,T){for(var W,U=O(T.id,S),V=0,X=U;W=X&&X[V];V++)W.controller.onunload&&(W.handler.call(W.controller,T,W.path),W.controller.onunload=0)},Q=function(S,T){return mag.utils.callLCEvent('willload',mag.mod.getState(S),T,S,1)},R=function(S,T){var U=mag.utils.items.getItemVal(S);if(h(U)&&mag.mod.exists(S))return mag.utils.callLCEvent('didload',mag.mod.getState(S),T,S,1)};mag.getNode=h})(window||global||this,document),function(b){'use strict';function f(u,w){var y=u.name;if('undefined'==typeof u.object[u.name]&&'_'!=y[0]){var z=b.fill.find(w,y),A='$'===y[0],B=[];return z.length?(z.forEach(function(G){var H;if(!(G&&G.type&&!~['submit','button'].indexOf(G.type)))'undefined'==typeof u.oldValue&&'undefined'==typeof u.object[u.name]&&G&&!~['submit','button'].indexOf(G.type)&&1==G.childNodes.length&&G.childNodes[0].textContent.trim()&&(H={_text:G.childNodes[0].textContent.trim()});else if(G.value&&0<G.value.length)if('checkbox'!=G.type&&'radio'!=G.type){var K=G.multiple&&Array.prototype.map.call(G.selectedOptions,L=>L.value);H={_value:K||G.value}}else if(G.checked&&(H={},H._checked=!0),!A){var I=w.querySelectorAll('[name='+G.name+']');if(I.length)for(var J of I)J.checked&&(H?H._value=J.value:H={_value:J.value})}else H?H._value=G.value:H={_value:G.value};H?B.push(H):G&&!G.hasChildNodes()&&B.push(j)}),0===B.length?void 0:A?B:B[0]&&'undefined'!=typeof B[0]._value?B[0]._value:B[0]&&B[0]._text?B[0]._text:B[0]):j}if('_'==y[0]){var C=y.substr(1);if(w.length){var B=[];for(var D in w){var E=w[D],F=E[C];'undefined'==typeof F&&(F=E.getAttribute(C)),B.push(F)}return B}var F=w[C];return'undefined'==typeof F&&(F=w.getAttribute(C)),F}}function g(u,w){return new u(b.proxy({},t.bind({},'state',w)))}var h=[],j=b.MAGNUM,n={runningViewInstance:-1,innerMods:[],cache:[]};n.getState=function(u){return h[u][1]},n.setState=function(u,w){h[u][1]=w},n.getView=function(u){return h[u][0]},n.getProps=function(u){return h[u]&&h[u][2]},n.setProps=function(u,w){return h[u][2]=w},n.remove=function(u){h[u]&&(h[u]=0)},n.getId=function(u){return h[u]&&h[u][3]},n.exists=function(u){return'undefined'!=typeof h[u]},n.setFrameId=function(u,w){h[u][4]=w},n.getFrameId=function(u){return h[u][4]},n.getMod=function(u){return h[u][5]};var o=(u,w)=>{for(var y in w=w||u,u){var z=u[y];'function'!=typeof z||~['controller','view'].indexOf(y)||(u[y]=z.bind(w))}return u};n.submodule=function(u,w,y,z){if(h[w])return z.key&&z.key==n.getProps(w).key?n.setProps(w,b.utils.copy(b.utils.merge(n.getProps(w),z))):n.setProps(w,z),h[w];y=b.utils.copy(y),o(y,y),h[w]=[0,0,0,0,0,0],z.children||(z.children=D=>{var E;return D&&(E=D),()=>E}),n.setProps(w,z);var B=function(D,E,F){y.element=F,y.state=E,y.props=n.getProps(D),y.view&&y.view.call(y,E,y.props,F)}.bind({},w),C={controller:function(D){return y.props=n.getProps(w),y.state=D,y.element=b.getNode(u),(y.controller||function(){}).call(D,y.props)||D},view:B};return h[w][0]=C.view,h[w][3]=u,h[w][1]=g(C.controller,w,u),h[w][5]=y,h[w]};var q=[],r=function(u,w){var y=u,z=w.split('/');for(var A of z)if(A){var B=b.fill.find(y,A);B.length&&(y=B)}return y},t=function(u,w,y){if('get'==y.type&&'props'!=u&&!~b.fill.ignorekeys.indexOf(y.name.toString())&&'undefined'==typeof y.oldValue){var z=b.getNode(n.getId(w));if(y.path&&'/'==y.path[0])var A=r(z,y.path);A&&'$'!=y.path.split('/').pop()[0]&&(A=A[0]);var B=f(y,A?A:z);if(null!==B&&'object'==typeof B&&y.object&&b.utils.merge(B,y.object[y.name]),B)return n.cached[w]=0,B}else'set'==y.type&&'props'!=u&&y.object[y.name]&&y.object[y.name].draw&&'function'==typeof y.object[y.name].draw&&(n.innerMods[n.getId(w)]=[y.name,y.object[y.name]]);var C=n.getFrameId(w);'function'==typeof C&&'set'==y.type&&(cancelAnimationFrame(q[w]),q[w]=requestAnimationFrame(C))};n.iscached=function(u){var w=b.utils.toJson([n.getProps(u),n.getState(u)]);return u in n.cache&&n.cache[u]==w||void(n.cache[u]=w)},n.clear=function(u){~u&&n.cache[u]&&n.cache.splice(u,1)},n.cached=[],n.callView=function(u,w){n.runningViewInstance=w,n.cached[w]||(b.props.attachToArgs(w,n.getState(w),u),n.cached[w]=1);try{n.getView(w)(n.getState(w),u)}finally{n.runningViewInstance=-1}},b.mod=n}(mag),function(b){'use strict';function g(y,z,A,B){var C=[];for(var D in y){var E=y[D];j(E)&&(C.push(E),h(E,z,A,B))}return!!C.length&&(1==C.length?C[0]:C)}function h(y,z,A,B){if(y[q]=y[q]||{},!y[q].eventOnFocus){var C=function(D,E,F){var H=~['radio','checkbox'].indexOf(y.type);if(this[q].dirty||(this[q].dirty=1),y.selectedOptions)var I=Array.prototype.map.call(y.selectedOptions,J=>J.value);H?'_checked'in E||o in E?E._checked=this.checked:this.checked&&(E[F]=this.value):void 0===E[o]?void 0!==E._text&&(E._text=I||this.value):E[o]=I||this.value,b.redraw(D,b.utils.items.getItem(D.id))}.bind(y,B,z,A);y.addEventListener('click',C),y.addEventListener('input',C),y.addEventListener('change',C),y.addEventListener('focus',C),y[q].eventOnFocus=1}}function j(y){return y&&~['INPUT','SELECT','TEXTAREA'].indexOf(y.tagName)}function l(y){for(var z in y)if(j(y[z]))return y[z];return!1}var n={},o='_value',q=b.MAGNUM,r=function(y,z){for(var A=1;A<y.length;A++){var B=y[A],C=y[A+1],D=b.fill.find(Array.isArray(z)?z[0]:z,B);if(C&&!isNaN(+C))z=D[C];else if(D&&D.length&&C&&A+2<y.length)z=b.fill.find(D[0],C);else if(D&&D.length&&(z=D,A+2==y.length))break}return Array.isArray(z)?z[0]:z},t=function(y,z,A,B){var D,C=A.toString().split('.');if(3<=C.length)B=r(C,B),D=b.fill.find(B,z);else{var E=parseInt(C.pop()),F=isNaN(E)?0:E;D=b.fill.find(B[F]?B[F]:B,z)}return g(D,y,z,B)},u=function(y,z,A,B){var C=A[z];~[o,'_checked','_text'].indexOf(z)&&'string'==typeof y&&(z=y.split('.').pop());var D=b.fill.find(B,z),E=l(D);if('function'!=typeof C&&E){var F=t.bind({},A,z,y,B);F(),Object.defineProperty(A,z,{configurable:!0,get:function(){var G=F();return G&&'undefined'!==G.value&&G[q]&&G[q].dirty&&G.value!==C?(C=G.value,b.redraw(B,y,1),G.value):C},set:function(G){var H=F();H&&'undefined'!==H.value&&H.value!==G&&G!==C&&(H.value=G,C=G)}})}},w=function(y,z,A){for(var B in z)if(z.hasOwnProperty(B)){var C=z[B];B==o||'object'!=typeof C||b.utils.isHTMLEle(C)?u.bind({},y,B,z,A)():(b.utils.isObject(C)&&b.utils.isEmpty(C)&&(C[o]=''),w(y+'.'+B,C,A))}};n.attachToArgs=w,b.props=n}(mag),function(b){'use strict';function f(t,u,w){var y,z=b.rafRate||16.67;n=0;do{var A=j.shift();A&&A(),y=performance.now()}while(j.length&&y-u<z);j.length?g.scheduleFlush(w).then(t):t()}var g={};g.copy=t=>Object.assign({},t),g.merge=function(){return Object.assign.apply({},arguments)},g.extend=function(t,u,w){for(var y in u)if(u[y]===void 0)delete u[y];else if(w&&g.isObject(u[y]))return g.extend(t[y],u[y]);return g.merge(t,u)},g.isObject=t=>'Object]'==Object.prototype.toString.call(t).substr(-7);var h=(t,u)=>'function'==typeof u?''+u:u;g.toJson=t=>JSON.stringify(t,h),g.isEmpty=t=>{for(var u in t)if(t.hasOwnProperty(u))return 0;return 1},g.isHTMLEle=t=>t&&1===t.nodeType,g.callHook=function(t,u,w,y,z,A){t[w][y].key==u&&(A={v:z.value,k:z.key},z.change=!1,t[w][y].handler.call(t[w][y].context,z),{v:z.value,k:z.key}!==A&&(z.change=!0))};var n,j=[],l=[],o=[];g.scheduleFlush=function(t,u){return new Promise(function(w){b.rafBounce||b.rafBounceIds[t]&&u?(l[t]&&(o[t](),cancelAnimationFrame(l[t])),o[t]=w,l[t]=requestAnimationFrame(()=>{l[t]=0,u(),w()})):(u&&j.push(u),!n&&(n=requestAnimationFrame(y=>f(w,y,t))))})};var q=[];g.onLCEvent=function(t,u,w){var y=t+'-'+u;q[y]=q[y]||[];var z=q[y].push(w);return function(){return q[y].splice(z-1,1)}},g.callLCEvent=function(t,u,w,y,z,A){var B;g.runningEventInstance=y;var C=b.mod.getProps(y),D=b.mod.getMod(y),E=D[t]?D:u[t]&&u;E&&(B=E[t].call(D,w,C,y,A),z&&(E[t]=0));var F=t+'-'+y;if(q[F]){for(var G of q[F])G(u,C);z&&(q[F]=0)}return(g.runningEventInstance=-1,!1===B)||void 0};var r={i:[],isItem:t=>~r.i.indexOf(t),setItem:t=>r.i[r.i.length]=t,getItem:t=>r.i.indexOf(t),getItemVal:t=>r.i[t],removeItem:t=>r.i.splice(r.i.indexOf(t),1)};g.items=r,g.getItemInstanceIdAll=()=>r.i,g.getItemInstanceId=t=>{return r.isItem(t)?r.getItem(t):(r.setItem(t),r.getItem(t))},b.utils=g}(mag),function(b,f,g){'use strict';function h(ha){return Array.isArray(ha)}function j(ha,ia){return ha[Y]=ha[Y]||{},(!ha[Y].uid||ia)&&(ha[Y].uid=++da),ha[Y].uid}function l(ha,ia){var ja=j(ha);return aa[ja]&&!ia?aa[ja]:aa[ja]=u(ha)}function n(ha){for(var ia=1;ha=ha.previousElementSibling;)++ia;return ia}function o(ha,ia){var ja=j(ha);return ba[W.id]=ba[W.id]||[],ba[W.id][ja]&&ba[W.id][ja]==ia?1:void(ba[W.id][ja]=ia)}function q(ha){return ha.id&&b.utils.items.isItem(ha.id)?ha:ha.parentNode?q(ha.parentNode):void 0}function r(ha,ia){if(ha[Y]&&ha[Y].scid&&!ha[Y].pscid)ia=ha;else if(ia)return ia;return ha.parentNode?r(ha.parentNode,ia):void 0}function t(ha){var ia='',ja=q(ha),ka=n(ha);return ja&&(ia+='id("'+(ja.id||ja.tagName)+'")'),ia+='/'+ha.tagName+'['+ka+']',ia}function u(ha){if(ha.id&&W.id===ha.id||W.id===ha)return'id("'+(ha.id||ha.tagName)+'")';if(ha===b.doc.body)return ha.tagName;var ja=0;if(ha.parentNode)for(var na,ka=ha.parentNode.childNodes,la=0,ma=ka.length;la<ma;la++){if(na=ka[la],na===ha)return u(ha.parentNode)+(ha.tagName?'/'+ha.tagName+'['+(ja+1)+']':'');1===na.nodeType&&na.tagName===ha.tagName&&ja++}}function w(ha){var ia=u(ha);ha&&X[ia+'-config']&&X[ia+'-config'].configContext&&typeof X[ia+'-config'].configContext.onunload==='function'&&(X[ia+'-config'].configContext.onunload(X[ia+'-config'].configContext,ha,ia),delete X[ia+'-config'],delete W.configs[ia]),ha.parentNode&&ha.parentNode.removeChild(ha),b.mod.cached[b.utils.items.getItem(W.id)]=0}function y(ha){var ia=ha&&parseInt(ha.split('[').pop().slice(0,-1));return ia?parseInt(ia)-1:0}function z(ha){var ia=[];return ha.replace(/\[(.+?)\]/g,function(ja,ka){ia.push(ka)}),ia}function A(ha){return ha&&~ha.indexOf('id(')&&ha.split('id("')[1].split('")')[0]}function B(ha,ia,ja){var ka=j(ha);if(aa[ka])return aa[ka];if(ea[ka])return ea[ka];var la=+ja==+ja?ia+ja:ia,ma='object'==typeof W.id?W.id.tagName:W.id,na='string'==typeof ja?ja.split(')')[1]+'/':'/',oa='id("'+ma+'")'+na+ha.tagName+'['+la+']';return ea[ka]=ha[Y].xpath=oa}function C(ha){if(ha&&ha[Y]&&ha[Y].isItem)return ha;return ha.parentNode?C(ha.parentNode):void 0}function D(ha,ia){if(!o(ha,ia.outerHTML)&&(!ia.id&&!ha.childNodes[0]||ia.id&&!b.doc.getElementById(ia.id)||ha.firstChild&&!ha.firstChild.isEqualNode(ia))){var ja=b.utils.items.getItem(ia.id);if(~ja&&ha.hasChildNodes()){var ka=b.utils.items.getItem(W.id),la=ha.cloneNode(1);la[Y]={childof:ka},b.mod.getProps(ja).children=la}else ia[Y]&&ia[Y].scid&&(la=ha.cloneNode(1),la[Y]={childof:ia[Y].scid},b._cprops[ia[Y].scid]=la);for(;ha.lastChild;)ha.removeChild(ha.lastChild);if(ia[Y]&&ia[Y].childof!==g){ha.innerHTML=ia.innerHTML;var ma=ia[Y].childof;b._cprops[ma]||(E(ha,ma),b.utils.onLCEvent('willupdate',ma,()=>{E(ha,ma)}))}else ha.appendChild(ia)}}function E(ha,ia){var ja=W.id;W.setId(b.mod.getId(ia)),W.run(ha,b.mod.getState(ia)),W.setId(ja)}function F(ha,ia){var ja;for(var ka in ia){var la=ia[ka];la===g?la='':null===la&&-1===['onunload'].indexOf(ka)?(ha[Y].detached=ha[Y].detached||[],ha[Y].detached[ka]=1,J(ha,ka)):ha[Y].detached&&ha[Y].detached[ka]&&(I(ha,ka),ha[Y].detached[ka]=0),'_'===ka[0]&&'_'!==ka[1]&&(ja=ja||{},ja[ka.substr(1)]=la)}return ja}function G(ha,ia,ja){var ka;for(var la in ia){var ma=ia[la];if(!~W.ignorekeys.indexOf(la)&&'_'!==la[0]){ka=S(ha,la);var na={key:la,value:ma,node:ha};b.hook('values','*',na),na.change&&(ma=na.value),W.run(ka,ma,ja+'/'+la)}}}function H(ha,ia,ja,ka){var la,pa=y(ja);return ia&&b.utils.isHTMLEle(ia)?void D(ha,ia):'function'==typeof ia?fa(ia,ha,pa,ja):'object'==typeof ia?void(b.mod.innerMods[W.id]&&ia[b.mod.innerMods[W.id][0]]&&!ia[b.mod.innerMods[W.id][0]].draw&&b.mod.innerMods[W.id][1].destroy(),la=F(ha,ia),la&&O(ha,la,ja,ka),G(ha,ia,ja)):H(ha,{_text:ia},ja)}function I(ha,ia){var ja=S(ha,ia);ja.forEach(function(ka){var la=j(ka);if(la in ga){for(var ma in ga[la])ka.appendChild(ga[la][ma]);delete ga[la]}})}function J(ha,ia){var ja=0,ka=1,la=function(oa){if(++ja==ka)for(;oa.lastChild;)w(oa.lastChild)},ma=function(oa,pa){var qa;oa.id&&b.utils.items.isItem(oa.id)&&(qa=b.utils.items.getItem(oa.id)),qa&&b.mod.getState(qa).onbeforeunload?(ka++,b.utils.callLCEvent('onbeforeunload',b.mod.getState(qa),oa,qa,0,function(){qa&&b.utils.callLCEvent('onunload',b.mod.getState(qa),oa,qa),pa()})):(qa&&b.utils.callLCEvent('onunload',b.mod.getState(qa),oa,qa),pa())},na=S(ha,ia);na.forEach(function(oa){var pa=j(oa);oa.children.length&&(ga[pa]=K(oa.children));for(var ra in ga[pa]){var sa=ga[pa][ra];ma(sa,function(){la(oa)})}la(oa)})}function K(ha){var ia;if(null==ha.length&&(ha=[ha]),!h(ha)){ia=[];for(var ja=0;ja<ha.length;ja+=1)ha[ja]&&ia.push(ha[ja]);ha=ia}return ha}function L(ha,ia){var ja=function(ka,la,ma){var na=t(la),oa=A(na);oa||(oa=r(la));var pa=W.id;W.setId(oa);var qa=C(la),ra=qa&&u(qa),sa=y(ra),na=na,ta=y(na),ua={path:ra,node:qa,data:((qa||{})[Y]||[]).dataPass,index:sa};W.setId(pa);var va=b.doc.getElementById(oa),wa=b.utils.items.getItem(oa),xa=ka.call(~wa?b.mod.getMod(wa):va,ma,ta,la,ua);if(oa&&va){var ya=function(){b.redraw(va,wa,1)};xa&&xa.then?xa.then(function(za){return ya(),za}):ya()}return xa}.bind({},ia,ha);return ja}function M(ha,ia){function ja(ka){var la=ha[Y].eventHandlers[ia];for(var ma in la){var na=la[ma],oa=L(ha,na),pa=oa(ka);!1===pa&&ka.preventDefault()}}ha.removeEventListener(ia,ja),ha.addEventListener(ia,ja)}function N(ha,ia,ja,ka){var la=ia.substr(2).toLowerCase(),ma=('string'==typeof ka?ka.split('/')[0]:'')+'-'+ja[Y].uid,na=ja[Y].events=ja[Y].events||[],oa=ja[Y].eventHandlers=ja[Y].eventHandlers||[];oa[la]=oa[la]||[],oa[la][ma]=ha,na[la]||(na[la]=1,M(ja,la))}function O(ha,ia,ja,ka){var la=y(ja);for(var ma in X[j(ha)]=X[j(ha)]||[],ia)if('text'!==ma&&'html'!==ma)if(0==ma.indexOf('on'))N(ia[ma],ma,ha,ka);else{if('config'==ma){var ja=l(ha),la=y(ja),na=!0;X[ja+'-config']?na=!1:X[ja+'-config']={};var oa=X[ja+'-config'].configContext=X[ja+'-config'].configContext||{},pa=function(ta,ua){return function(){return ta.apply(ta,ua)}};f[ja]=pa(ia[ma],[ha,na,oa,la]);continue}var qa={key:ma,value:ia[ma],node:ha};if(b.hook('attributes',ma,qa),qa.change&&(ma=qa.key,ia[ma]=qa.value),X[j(ha)]&&X[j(ha)][ma]==ia[ma])continue;null===ia[ma]?ha.removeAttribute(ma):'value'==ma&&ha.multiple&&ha.selectedOptions&&Array.isArray(ia[ma])?(ha.value=ia[ma],ia[ma].forEach(function(ta){Array.from(ha.options).find(ua=>ua.value==ta).selected=!0})):ma in ha?'style'==ma?ha[ma].cssText=ia[ma]:ha[ma]=ia[ma]:ha.setAttribute(ma,ia[ma]+''),X[j(ha)][ma]=ia[ma]}P(ha,ia.text),R(ha,ia.html)}function P(ha,ia){if(ha&&null!=ia&&!o(ha,ia)){var ja=ia+'';if('INPUT'!==ha.nodeName)'SELECT'!==ha.nodeName&&(ha.firstChild?ha.firstChild.textContent=ja:ha.appendChild(ha.ownerDocument.createTextNode(ja)));else if(!~['radio','checkbox'].indexOf(ha.type))ja!=ha.value&&(ha.value=ja);else if(ha.name){var ka=b.getNode(W.id).querySelectorAll('[name='+ha.name+']');if(1<ka.length)for(var la of ka)if(la.value==ja){la.checked=!0;break}}'SELECT'===ha.nodeName&&ja&&(ha.value=ja)}}function Q(ha,ia,ja){!ia||ha.childNodes[ja]&&ha.childNodes[ja].isEqualNode(ia)||(ha.childNodes[ja]?ha.replaceChild(ia,ha.childNodes[ja]):ha.appendChild(ia))}function R(ha,ia){if(Array.isArray(ia)){for(var ja in ia)Q(ha,ia[ja],ja);return}return b.utils.isHTMLEle(ia)?void Q(ha,ia,0):void(!ha||null==ia||o(ha,ia)||(ha.innerHTML=ia))}function S(ha,ia,ja){var ka=U(ha),la=[],ma=ia,na='$'===ia[0];'$'===ma[0]&&(ma=ma.substr(1));for(var oa=0;oa<ka.length;oa+=1)V(ka[oa],ma)&&la.push(ka[oa]);if(!la.length||na)for(var oa=0;oa<ka.length&&(la=la.concat(S(ka[oa],ia,!0)),!la.length||na);oa++);if(!ja&&!la.length){var pa={key:ia,value:la,node:ha};b.hook('elementMatcher',ia,pa),pa.change&&(la=pa.value)}return la}function T(ha){return W.id&&(b.utils.isHTMLEle(W.id)&&ha[Y]&&ha[Y].scid||ha.id&&ha.id!=W.id&&b.utils.items.isItem(ha.id))?0:1}function U(ha){var ia=[];if(ha){var ja=ha.childNodes;if(ja)for(var ka=0;ka<ja.length;ka+=1)1===ja[ka].nodeType&&T(ja[ka])&&ia.push(ja[ka])}return ia}function V(ha,ia){var ja=' '+ha.className+' ';return ha.id===ia||~ja.indexOf(' '+ia+' ')||ha.name===ia||ha.nodeName.toLowerCase()===ia.toLowerCase()||ha.getAttribute('data-bind')===ia}var W={cached:[],ignorekeys:['toString','draw','then','hasOwnProperty','willgetprops','onbeforeunload','Symbol(Symbol.toStringTag)','nodeType','toJSON','onunload','willupdate','didupdate','didload','willload','isupdate']},X=W.cached,Y=b.MAGNUM,$='undefined',_='_key',aa=[],ba=[],ca={},da=0;W.run=function(ha,ia,ja){var ka,la;if(ha){null==ia&&(ia={_text:''});var ma=K(ha);if(la=h(ia),la){if(ca[ja]&&0===ma.length&&(ca[ja].parent.insertAdjacentHTML('beforeend',ca[ja].node),ma=K(ca[ja].parent.children)),!ma.length)return;var na=ma[0].parentNode;ca[ja]||(ca[ja]={node:ma[0].cloneNode(1).outerHTML,parent:na});for(var oa=b.doc.createDocumentFragment(),pa=0;ma.length<ia.length;)ca[ja]?(na.insertAdjacentHTML('beforeend',ca[ja].node),ka=na.lastChild):ka=ma[0].cloneNode(1),B(ka,++pa,ja),ma.push(ka),oa.appendChild(ka);na.appendChild(oa);var qa=ia.map(function(va){return va&&va[_]});if((ma.length==ia.length||-1!==qa.indexOf(g))&&(ia=ia.map(function(va,wa){if('object'==typeof va){if(ma[wa][Y]=ma[wa][Y]||{},ma[wa][Y].__key&&typeof va[_]==$)return va[_]=ma[wa][Y].__key,va;typeof va[_]==$&&(va[_]=Y+wa),ma[wa][Y].__key=va[_]}return va})),ma.length>ia.length)if(0===ia.length||'object'!=typeof ia[0])for(;ma.length>ia.length;)ka=ma.pop(),na=ka.parentNode,na&&w(ka);else{var ra=[],sa=ia.map(function(va){return va[_]});ma=ma.filter(function(va){var xa;return(typeof va[Y]==$?xa=1:(!~sa.indexOf(va[Y].__key)||~ra.indexOf(va[Y].__key))&&(ra.push(va[Y].__key),xa=1),xa)?(w(va),!1):(ra.push(va[Y].__key),!0)})}}for(var ta=0;ta<ma.length;ta++)if(la)ma[ta]&&W.run(ma[ta],ia[ta],ta);else{var ua=B(ma[ta],ta+1,ja);ia&&'object'==typeof ia&&ia.hasOwnProperty(_)&&!b.utils.isHTMLEle(ia)&&(ma[ta][Y].isItem=!0,ma[ta][Y].dataPass=ia),H(ma[ta],ia,ua,ja)}}};var ea=[],fa=function(ha,ia,ja,ka){ka=l(ia),ja=z(ka);var la=ha(ja.join('.'),ka);return la&&b.utils.isHTMLEle(la)?void(D(ia,la),ia[Y]=ia[Y]||{},ia[Y].isItem=!0,ia[Y].dataPass={index:ja},ha.draw&&ha.draw()):H(ia,la,ka)},ga=[];W.removeNode=w,W.configs=f,W.find=S,W.setId=ha=>{W.id=ha},W.clearCache=ha=>{ba[ha]&&delete ba[ha]},b.fill=W}(mag,[]),function(b){function g(j,l,n,o){function q(t){return r.has(t)}var r=new WeakSet;return new Proxy(j,{get:function(t,u,w){var y=t[u];if('symbol'==typeof u)return y;if('object'!=typeof y||'symbol'==typeof y||null===y||'function'==typeof y||Array.isArray(y)||!b.utils.isObject(y)||y.then||y.draw)u in t||~b.fill.ignorekeys.indexOf(u.toString())||n||'_'==u[0]||(y=b.proxy({},l,n,o+h+u));else if(!q(y))return r.add(y),b.proxy(y,l,n,o+h+u);var z=l({type:'get',object:t,name:u,path:o,oldValue:Reflect.get(t,u,w)});return'undefined'!=typeof z&&(y=z==b.MAGNUM?void 0:z),y},deleteProperty:function(t,u){return l({type:'delete',name:u,object:t,oldValue:Reflect.get(t,u)}),Reflect.deleteProperty(t,u)},set:function(t,u,w,y){var z=Reflect.get(t,u,y);return z===w&&'length'!==u||(l({type:'set',name:u,object:t,oldValue:z}),Reflect.set(t,u,w,y))}})}var h='/';b.proxy=function(j,l,n,o){for(var q in j){var r=typeof j[q];Array.isArray(j[q])&&101>j[q].length?j[q]=g(j[q],l):'object'==r&&null!==j[q]&&'symbol'!=typeof q&&'symbol'!=r&&'function'!=r&&b.utils.isObject(j[q])&&(j[q]=b.proxy(j[q],l,n,o+h+q))}return g(j,l,n,o||h)}}(mag,window||global||this);
