/*
Mag.JS v0.26.8
http://github.com/magnumjs/mag.js
(c) Michael Glazer
License: MIT
*/
(function(b,c){'use strict';function g(P,Q){if(u[P]&&!Q)return u[P];var R=mag.doc.getElementById(P);return R&&(u[P]=R),u[P]}var h='KEY',j=['#'+h,'.'+h,h],l=function(P,Q){var R;for(var S in j){var T=j[S].replace(h,Q);if(R=P.querySelector(T),R)break}return R},n=function(P){var Q=mag.utils.items.getItemVal(P),R=mag.getNode(Q);return R},q=function(P){if('string'==typeof P){var Q=n(~mag.mod.runningViewInstance||mag.utils.runningEventInstance),R=l(Q||mag.doc,P);if(R)return R}return P},r=function(P,Q){var U,R=[],S=P.cloneNode(1),T=[];return function(V){var W=P;if(V){var X=V.key;X&&!R[X]?W=R[X]=S.cloneNode(1):X&&R[X]&&(W=R[X])}if(!U||!V||U!=JSON.stringify(V)){U=JSON.stringify(V);var Y;Y=U in T?T[U]:T[U]=Q(V),mag.fill.run(W,Y)}return W}};b.mag=function(P,Q,R){return P=q(P),Q=q(Q),mag.utils.isHTMLEle(Q)&&mag.utils.isHTMLEle(P)?void(Q[mag.MAGNUM]||mag.fill.run(Q,P)):'function'==typeof Q&&mag.utils.isHTMLEle(P)?r(P,Q):H(-1,g(mag._isNode(P)),Q,R||{})},mag.MAGNUM='__magnum__',mag.doc=c;var t={values:[],attributes:[],elementMatcher:[]},u=[],v=0;mag._isNode=function(P){return mag.utils.isHTMLEle(P)&&(!P.id&&(P.id=++v),u[P.id]=P,P=P.id),P};var w=function(P,Q){var R,S=Q?P+'-'+Q:P;return R=mag.utils.items.isItem(S)?mag.utils.items.getItem(S):mag.utils.getItemInstanceId(S),R};mag.module=function(P,Q,R){R=R||{},P=mag._isNode(P);var S=w(P,R.key),T=x(R,S,Q,P);return T?H(S,T,Q,mag.utils.copy(R)):void 0};var x=function(P,Q,R,S){P.retain||mag.mod.clear(Q),mag.mod.submodule(S,Q,R,P);var T=g(S);if(I(Q,S),!N(Q,T))return mag.redraw(T,Q,1).then(function(){O(Q,T)}),T},y=function(P,Q){return 0>Q||Q!=mag.utils.items.getItem(P)?P==mag.mod.getId(Q):!0},z=[];mag.begin=function(P){'undefined'==typeof z[P]?z[P]=1:z[P]++},mag.end=function(P){if(1<z[P])z[P]--;else{z[P]=0;var Q=mag.utils.items.getItemVal(P);mag.redraw(g(Q),P)}},mag.redraw=function(P,Q,R){if(!z[Q]){if(!P||'undefined'==typeof Q)throw Error('Mag.JS - Id or node invalid: '+mag.utils.items.getItemVal(Q));if(!y(P.id,Q))return{then:()=>{}};if(R&&mag.fill.configs.splice(0,mag.fill.configs.length),R&&mag.mod.clear(Q),mag.mod.runningViewInstance==Q)throw Error('Mag.JS - recursive call: '+Q);var S=J(P,Q,R);return mag.utils.scheduleFlush(S)}},mag.hookin=function(P,Q,R){t[P].push({context:{},handler:R,key:Q})},mag.hook=function(P,Q,R){for(var S=0,T=t[P].length;S<T;S++)mag.utils.callHook(t,Q,P,S,R)};var A={},B=[],C=[],D=function(P,Q,R){var S=mag.getNode(mag.mod.getId(P)),T=function(){mag.utils.callLCEvent('onunload',mag.mod.getState(P),S,P)||(mag.clear(P),M(P,S),Q[P]&&(Q[P].length=0),R&&(mag.fill.removeNode(S),mag.mod.remove(P)))};mag.mod.getState(P).onbeforeunload?mag.utils.callLCEvent('onbeforeunload',mag.mod.getState(P),S,P,0,function(){T()}):T()},E=function(P,Q){C[P]=C[P]||[];var R=C[P].push(Q);return mag.utils.onLCEvent('didupdate',P,function(S,T){var U=mag.utils.merge(mag.utils.copy(T),mag.utils.copy(S));if(JSON.stringify(U)!==JSON.stringify(B[P])){for(var V of C[P])V(S,T,g(mag.mod.getId(P)),B[P]);B[P]=U}}),function(){return C[P].splice(R-1,1)}},F=[],G=function(P,Q,R,S,T){var U=mag.utils.items.getItem(Q);(O(U,P),!(mag.mod.exists(U)&&mag.utils.callLCEvent('willgetprops',mag.mod.getState(U),P,U,0,R)))&&(mag.mod.submodule(P.id,U,S,R),I(U,P.id),N(U,P)||mag.redraw(P,U,T).then(function(){O(U,P)}))},H=function(P,Q,R,S){F[P]=F[P]||[];var T=function(U,V,W,X,Y){'object'==typeof Y&&(X=mag.utils.merge(mag.utils.copy(X),Y),Y=0);var Z=V.id+(X.key?'.'+X.key:'')+'.'+(Y||0);!A[Z]||X.key||~T._id||(Z+=++v);var $=A[Z]=A[Z]||V.cloneNode(1);if($.id=Z,mag.utils.items.isItem(Z))return G($,Z,X,W,1),$;var _=mag.utils.getItemInstanceId($.id);return 0>U?U=T._id=_:F[U].push({instanceId:_,subscribe:E.bind({},_)}),G($,Z,X,W,1),$}.bind({},P,Q,R,S);return T._id=P,T.clones=function(){return F[T._id]},T.destroy=function(U){D(T._id,T.clones,U)},T.getId=function(){return T._id},T.draw=function(U){return mag.redraw(Q,T._id,U)},T.getState=function(){return mag.mod.getState(T._id)},T.getProps=function(){return mag.mod.getProps(T._id)},T.subscribe=function(U){return E(T._id,U)},T},I=function(P,Q){var R=function(S,T){g(T)?mag.redraw(g(T),S):mag.utils.items.isItem(T)&&mag.clear(S)}.bind({},P,Q);mag.mod.setFrameId(P,R)};mag.clear=function(P){mag.utils.items.removeItem(P),mag.mod.clear(P),mag.fill.clearCache(mag.mod.getId(P))};var J=function(P,Q,R){return function(S,T,U){if(g(S.id,1),y(S.id,T)&&S){var V=mag.mod.getState(T);return mag.utils.callLCEvent('isupdate',V,S,T)?void 0:mag.mod.iscached(T)&&!U?0:void(mag.utils.callLCEvent('willupdate',V,S,T)||(mag.mod.callView(S,T),mag.fill.setId(S.id),mag.fill.run(S,V),K(S.id,mag.fill.configs),mag.utils.callLCEvent('didupdate',V,S,T),!U&&mag.mod.iscached(T)))}}.bind({},P,Q,R)},K=function(P,Q){for(var R in Q)R.startsWith('id("'+P+'")/')&&Q[R]()},L=function(P){var R=[];for(var S in mag.fill.cached)-1<S.indexOf('id("'+P+'")/')&&-1<S.indexOf('-config')&&mag.fill.cached[S].configContext&&R.push({path:S.split('-config')[0],controller:mag.fill.cached[S].configContext,handler:mag.fill.cached[S].configContext.onunload});return R},M=function(P,Q){for(var T,R=L(Q.id,P),S=0,U=R;T=U&&U[S];S++)T.controller.onunload&&(T.handler.call(T.controller,Q,T.path),T.controller.onunload=0)},N=function(P,Q){return mag.utils.callLCEvent('willload',mag.mod.getState(P),Q,P,1)},O=function(P,Q){var R=mag.utils.items.getItemVal(P);if(g(R))return mag.utils.callLCEvent('didload',mag.mod.getState(P),Q,P,1)};mag.getNode=g})(window||global||this,document),function(b){'use strict';function c(t,u){var v=t.name;if('undefined'==typeof t.object[t.name]&&'_'!==v[0]){var w=b.fill.find(u,v),x='$'===v[0],y=[];return w.length?(w.forEach(function(z){var A;if(!(z&&z.type&&!~['submit','button'].indexOf(z.type)))'undefined'==typeof t.oldValue&&'undefined'==typeof t.object[t.name]&&z&&!~['submit','button'].indexOf(z.type)&&1==z.childNodes.length&&z.childNodes[0].textContent.trim()&&(A={_text:z.childNodes[0].textContent.trim()});else if(z.value&&0<z.value.length)if('checkbox'!=z.type&&'radio'!=z.type)A={_value:z.value};else if(z.checked&&(A={},A._checked=!0),!x){var B=u.querySelectorAll('[name='+z.name+']');if(B.length)for(var C of B)C.checked&&(A?A._value=C.value:A={_value:C.value})}else A?A._value=z.value:A={_value:z.value};A?y.push(A):z&&!z.hasChildNodes()&&y.push(h)}),0===y.length?void 0:x?y:y[0]&&'undefined'!=typeof y[0]._value?y[0]._value:y[0]&&y[0]._text?y[0]._text:y[0]):h}}function f(t,u){var w;return l.setProps(u,b.proxy(l.getProps(u),r.bind({},'props',u),'prop')),w=new t(b.proxy({},r.bind({},'state',u))),w}var g=[],h=b.MAGNUM,l={runningViewInstance:-1,innerMods:[],cache:[]};l.getState=function(t){return g[t][1]},l.setState=function(t,u){g[t][1]=u},l.getView=function(t){return g[t][0]},l.getProps=function(t){return g[t][2]},l.setProps=function(t,u){return g[t][2]=u},l.remove=function(t){g.splice(t,1)},l.getId=function(t){return g[t]&&g[t][3]},l.exists=function(t){return'undefined'!=typeof g[t]},l.setFrameId=function(t,u){g[t][4]=u},l.getFrameId=function(t){return g[t][4]},l.submodule=function(t,u,v,w){if(g[u])return w.key&&w.key===l.getProps(u).key?l.setProps(u,b.utils.copy(b.utils.merge(l.getProps(u),w))):l.setProps(u,w),g[u];g[u]=[0,0,0,0,0],l.setProps(u,w);var y=function(A,B,C){v.view&&v.view.call(v,B,l.getProps(A),C)}.bind({},u),z={controller:function(A){return(v.controller||function(){}).call(A,l.getProps(u))||A},view:y};return g[u][0]=z.view,g[u][3]=t,g[u][1]=f(z.controller,u,t),g[u]};var n=[],q=function(t,u){var v=t,w=u.split('/');for(var x of w)if(x){var y=b.fill.find(v,x);y.length&&(v=y[0])}return v},r=function(t,u,v){if('get'==v.type&&'props'!=t&&!~b.fill.ignorekeys.indexOf(v.name.toString())&&'undefined'==typeof v.oldValue){var w=b.doc.getElementById(l.getId(u));if(v.path&&'/'==v.path[0])var x=q(w,v.path);var y=c(v,x?x:w);if('undefined'!=typeof y&&'object'==typeof y&&v.object&&b.utils.merge(y,v.object[v.name]),'undefined'!=typeof y)return l.cached[u]=0,y}else'set'==v.type&&'props'!=t&&v.object[v.name]&&v.object[v.name].draw&&'function'==typeof v.object[v.name].draw&&(l.innerMods[l.getId(u)]=[v.name,v.object[v.name]]);var z=l.getFrameId(u);'function'==typeof z&&'set'==v.type&&(cancelAnimationFrame(n[u]),n[u]=requestAnimationFrame(z))};l.iscached=function(t){var u=JSON.stringify(b.utils.merge(b.utils.copy(l.getProps(t)),l.getState(t)));return t in l.cache&&l.cache[t]==u||void(l.cache[t]=u)},l.remove=function(t){g[t]&&(g[t]=0)},l.clear=function(t){~t&&l.cache[t]&&l.cache.splice(t,1)},l.cached=[],l.callView=function(t,u){l.runningViewInstance=u,l.cached[u]||(b.props.attachToArgs(u,l.getState(u),t),l.cached[u]=1);try{l.getView(u)(l.getState(u),t)}finally{l.runningViewInstance=-1}},b.mod=l}(mag),function(b){'use strict';function f(v,w,x,y){var z=[];for(var A in v){var B=v[A];h(B)&&(z.push(B),g(B,w,x,y))}return!!z.length&&(1==z.length?z[0]:z)}function g(v,w,x,y){if(v[n]=v[n]||{},!v[n].eventOnFocus){var z=function(A,B,C){var E=~['radio','checkbox'].indexOf(v.type);this[n].dirty||(this[n].dirty=1),E&&('_checked'in B||'_value'in B?B._checked=this.checked:this.checked&&(B[C]=this.value)),b.redraw(A,b.utils.items.getItem(A.id))}.bind(v,y,w,x);v.addEventListener('click',z,!1),v.addEventListener('input',z,!1),v.addEventListener('focus',z,!1),v[n].eventOnFocus=1}}function h(v){return v&&~['INPUT','SELECT','TEXTAREA'].indexOf(v.tagName)}function j(v){for(var w in v)if(h(v[w]))return v[w];return!1}var l={},n=b.MAGNUM,q=function(v,w){for(var x=1;x<v.length;x++){var y=v[x],z=v[x+1],A=b.fill.find(Array.isArray(w)?w[0]:w,y);z&&!isNaN(+z)?w=A[z]:A&&A.length&&z?w=b.fill.find(A[0],z):A&&A.length&&(w=A)}return Array.isArray(w)?w[0]:w},r=function(v,w,x,y){var A,z=x.toString().split('.');if(3<=z.length)y=q(z,y),A=b.fill.find(y,w);else{var B=parseInt(z.pop()),C=isNaN(B)?0:B;A=b.fill.find(y[C]?y[C]:y,w)}return f(A,v,w,y)},t=function(v,w,x,y){var z=x[w];~['_value','_checked'].indexOf(w)&&(w=v.split('.').pop());var A=b.fill.find(y,w),B=j(A);if('function'!=typeof z&&B){var C=r.bind({},x,w,v,y);C(),Object.defineProperty(x,w,{configurable:!0,get:function(){var D=C();return D&&'undefined'!==D.value&&D[n]&&D[n].dirty&&D.value!==z?(z=D.value,b.redraw(y,v,1),D.value):z},set:function(D){var E=C();E&&'undefined'!==E.value&&E.value!==D&&D!==z&&(E.value=D,z=D)}})}},u=function(v,w,x){for(var y in w)if(w.hasOwnProperty(y)){var z=w[y];'object'!=typeof z||b.utils.isHTMLEle(z)?t.bind({},v,y,w,x)():u(v+'.'+y,z,x)}};l.attachToArgs=u,b.props=l}(mag),function(b){'use strict';var c={isObject:function(l){return'Object]'==Object.prototype.toString.call(l).substr(-7)},isHTMLEle:function(l){return l&&l.nodeType&&1==l.nodeType},callHook:function(l,n,q,r,t,u){l[q][r].key==n&&(u={v:t.value,k:t.key},t.change=!1,l[q][r].handler.call(l[q][r].context,t),{v:t.value,k:t.key}!==u&&(t.change=!0))}},f=!1,g=[];c.scheduleFlush=function(l){return new Promise(function(n){g.push(l),f?n():(f=!0,requestAnimationFrame(function(){for(var q;q=g.shift();)q();f=!1,n()}))})};var h=[];c.onLCEvent=function(l,n,q){var r=l+'-'+n;h[r]=h[r]||[];var t=h[r].push(q);return function(){return h[r].splice(t-1,1)}},c.callLCEvent=function(l,n,q,r,t,u){var v;c.runningEventInstance=r,n&&n[l]&&(v=n[l].call(n,q,b.mod.getProps(r),r,u),t&&(n[l]=0));var w=l+'-'+r;if(h[w]){for(var x of h[w])x(b.mod.getState(r),b.mod.getProps(r));t&&(h[l]=0)}return(c.runningEventInstance=-1,!1===v)||void 0},c.copy=function(l){return Object.assign({},l)},c.merge=function(){return Object.assign.apply({},arguments)};var j={i:[],isItem:function(l){return~j.i.indexOf(l)},setItem:function(l){j.i[j.i.length]=l},getItem:function(l){return j.i.indexOf(l)},getItemVal:function(l){return j.i[l]},removeItem:function(l){j.i.splice(j.i.indexOf(l),1)}};c.items=j,c.getItemInstanceIdAll=function(){return j.i},c.getItemInstanceId=function(l){return j.isItem(l)?j.getItem(l):(j.setItem(l),j.getItem(l))},b.utils=c}(mag),function(b,c,f){'use strict';function g(Y){return Array.isArray(Y)}function h(Y,Z){return Y[O]=Y[O]||{},(!Y[O].uid||Z)&&(Y[O].uid=++V),Y[O].uid}function j(Y,Z){var $=h(Y,Z);return S[$]?S[$]:S[$]=q(Y)}function l(Y,Z,$){var _=h(Y,$);return T[M.id]=T[M.id]||[],T[M.id][_]&&T[M.id][_]==Z?1:void(T[M.id][_]=Z)}function n(Y){return Y.id?Y:Y.parentNode?n(Y.parentNode):void 0}function q(Y){var Z='',$=n(Y),_=Y.parentNode&&[].indexOf.call(Y.parentNode.children,Y);return $&&(Z+='id("'+$.id+'")'),Z+='/'+Y.tagName+'['+(_+1)+']',Z}function r(Y){if(Y.id&&M.id===Y.id)return'id("'+Y.id+'")';if(Y===b.doc.body)return Y.tagName;var Z=0;if(Y.parentNode)for(var aa,$=Y.parentNode.childNodes,_=0;_<$.length;_++){if(aa=$[_],aa===Y)return r(Y.parentNode)+(Y.tagName?'/'+Y.tagName+'['+(Z+1)+']':'');1===aa.nodeType&&aa.tagName===Y.tagName&&Z++}}function t(Y){var Z=r(Y);Y&&N[Z+'-config']&&N[Z+'-config'].configContext&&typeof N[Z+'-config'].configContext.onunload==='function'&&(N[Z+'-config'].configContext.onunload(N[Z+'-config'].configContext,Y,Z),delete N[Z+'-config'],delete M.configs[Z]),Y.parentNode&&Y.parentNode.removeChild(Y),b.mod.cached[b.utils.items.getItem(M.id)]=0}function u(Y){var Z=Y&&parseInt(Y.split('[').pop().slice(0,-1));return Z?parseInt(Z)-1:0}function v(Y){return Y&&~Y.indexOf('id(')&&Y.split('id("')[1].split('")')[0]}function w(Y){if(Y&&Y[O]&&Y[O].isChildOfArray)return Y;return Y.parentNode?w(Y.parentNode):void 0}function x(Y,Z,$){if(!l(Y,Z.outerHTML,$)&&(!Z.id&&!Y.childNodes[0]||Z.id&&!b.doc.getElementById(Z.id)||Y.firstChild&&!Y.firstChild.isEqualNode(Z))){var _=b.utils.items.getItem(Z.id);for(b.mod.getProps(_).children=Y.innerHTML;Y.lastChild;)Y.removeChild(Y.lastChild);Y.appendChild(Z)}}function y(Y,Z){var $;for(var _ in Z){var aa=Z[_];aa===f?aa='':null===aa&&-1===['onunload'].indexOf(_)?(Y[O].detached=Y[O].detached||[],Y[O].detached[_]=1,C(Y,_)):Y[O].detached&&Y[O].detached[_]&&(B(Y,_),Y[O].detached[_]=0),'_'===_[0]&&'_'!==_[1]&&($=$||{},$[_.substr(1)]=aa)}return $}function z(Y,Z,$){var _;for(var aa in Z){var ba=Z[aa];if(!~M.ignorekeys.indexOf(aa)&&'_'!==aa[0]){_=I(Y,aa);var ca={key:aa,value:ba,node:Y};b.hook('values','*',ca),ca.change&&(ba=ca.value),g(ba)&&(_=I(Y,'$'+aa)),M.run(_,ba,$+'/'+aa)}}}function A(Y,Z,$){var _,da=u($);return Z&&b.utils.isHTMLEle(Z)?void x(Y,Z):'function'==typeof Z?W(Z,Y,da,$):'object'==typeof Z?void(b.mod.innerMods[M.id]&&Z[b.mod.innerMods[M.id][0]]&&!Z[b.mod.innerMods[M.id][0]].draw&&b.mod.innerMods[M.id][1].destroy(),_=y(Y,Z),_&&F(Y,_,$),z(Y,Z,$)):A(Y,{_text:Z},$)}function B(Y,Z){var $=I(Y,Z);$.forEach(function(_){var aa=h(_);if(aa in X){for(var ba in X[aa])_.appendChild(X[aa][ba]);delete X[aa]}})}function C(Y,Z){var $=0,_=1,aa=function(da){if(++$==_)for(;da.lastChild;)t(da.lastChild)},ba=function(da,ea){var fa;da.id&&b.utils.items.isItem(da.id)&&(fa=b.utils.items.getItem(da.id)),fa&&b.mod.getState(fa).onbeforeunload?(_++,b.utils.callLCEvent('onbeforeunload',b.mod.getState(fa),da,fa,0,function(){fa&&b.utils.callLCEvent('onunload',b.mod.getState(fa),da,fa),ea()})):(fa&&b.utils.callLCEvent('onunload',b.mod.getState(fa),da,fa),ea())},ca=I(Y,Z);ca.forEach(function(da){var ea=h(da);da.children.length&&(X[ea]=D(da.children));for(var ga in X[ea]){var ha=X[ea][ga];ba(ha,function(){aa(da)})}aa(da)})}function D(Y){var Z;if(null==Y.length&&(Y=[Y]),!g(Y)){Z=[];for(var $=0;$<Y.length;$+=1)Y[$]&&Z.push(Y[$]);Y=Z}return Y}function E(Y,Z,$){var _=function(aa,ba,ca){var da=w(ba),ea=da&&r(da),fa=u(ea),ga=j(ba,1),ha=u(ga),ia={path:ea,data:((da||{})[O]||[]).dataPass,node:da,index:fa},ja=v(ga),ka=b.doc.getElementById(ja),la=aa.call(ba,ca,ha,ba,ia);if(ja&&ka){var ma=function(){b.redraw(ka,b.utils.items.getItem(ja),1)};la&&la.then?la.then(function(na){return ma(),na}):ma()}return la}.bind({},Z[$],Y);return _}function F(Y,Z,$){var _=u($);for(var aa in N[h(Y)]=N[h(Y)]||[],Z)if('text'!==aa&&'html'!==aa)if(0==aa.indexOf('on'))Y[aa.toLowerCase()]=E(Y,Z,aa);else{if('config'==aa){var $=r(Y),_=u($),ba=!0;N[$+'-config']?ba=!1:N[$+'-config']={};var ca=N[$+'-config'].configContext=N[$+'-config'].configContext||{},da=function(ha,ia){return function(){return ha.apply(ha,ia)}};c[$]=da(Z[aa],[Y,ba,ca,_]);continue}var ea={key:aa,value:Z[aa],node:Y};if(b.hook('attributes',aa,ea),ea.change&&(aa=ea.key,Z[aa]=ea.value),N[h(Y)]&&N[h(Y)][aa]==Z[aa])continue;null===Z[aa]?Y.removeAttribute(aa):aa in Y?'style'==aa?Y[aa].cssText=Z[aa]:Y[aa]=Z[aa]:Y.setAttribute(aa,Z[aa]+''),N[h(Y)][aa]=Z[aa]}G(Y,Z.text),H(Y,Z.html)}function G(Y,Z){if(Y&&null!=Z&&!l(Y,Z)){var $=Z+'';if('INPUT'!==Y.nodeName)'SELECT'!==Y.nodeName&&(Y.firstChild?Y.firstChild.textContent=$:Y.appendChild(Y.ownerDocument.createTextNode($)));else if(!~['radio','checkbox'].indexOf(Y.type))$!=Y.value&&(Y.value=$);else if(Y.name){var _=b.getNode(M.id).querySelectorAll('[name='+Y.name+']');if(1<_.length)for(var aa of _)if(aa.value==$){aa.checked=!0;break}}'SELECT'===Y.nodeName&&$&&(Y.value=$)}}function H(Y,Z){!Y||null==Z||l(Y,Z)||(Y.innerHTML=Z)}function I(Y,Z,$){var _=K(Y),aa=[],ba=Z,ca='$'===Z[0];'$'===ba[0]&&(ba=ba.substr(1));for(var da=0;da<_.length;da+=1)L(_[da],ba)&&aa.push(_[da]);if(!aa.length||ca)for(var da=0;da<_.length&&(aa=aa.concat(I(_[da],Z,!0)),!aa.length||ca);da++);if(!$&&!aa.length){var ea={key:Z,value:aa,node:Y};b.hook('elementMatcher',Z,ea),ea.change&&(aa=ea.value)}return aa}function J(Y){return!b.utils.items.isItem(Y.id)}function K(Y){var Z=[];if(Y){var $=Y.childNodes;if($)for(var _=0;_<$.length;_+=1)b.utils.isHTMLEle($[_])&&J($[_])&&Z.push($[_])}return Z}function L(Y,Z){var $=' '+Y.className+' ';return Y.id===Z||~$.indexOf(' '+Z+' ')||Y.name===Z||Y.nodeName.toLowerCase()===Z.toLowerCase()||Y.getAttribute('data-bind')===Z}var M={cached:[],ignorekeys:['toString','draw','then','hasOwnProperty','willgetprops','onbeforeunload','Symbol(Symbol.toStringTag)','nodeType','toJSON','onunload','willupdate','didupdate','didload','willload','isupdate']},N=M.cached,O=b.MAGNUM,Q='undefined',R='_key',S=[],T=[],U={},V=0;M.run=function(Y,Z,$){var _,aa;if(Y){null==Z&&(Z={_text:''});var ba=D(Y);if(aa=g(Z),aa){if(U[$]&&0===ba.length&&(U[$].parent.insertAdjacentHTML('beforeend',U[$].node),ba=D(U[$].parent.children)),!ba.length)return;var ca=ba[0].parentNode;for(U[$]||(U[$]={node:ba[0].cloneNode(1).outerHTML,parent:ca});ba.length<Z.length;)U[$]?(ca.insertAdjacentHTML('beforeend',U[$].node),_=ca.lastChild):_=ba[0].cloneNode(1),ba.push(_),ca&&ca.appendChild(_);var da=Z.map(function(ia){return ia&&ia[R]});if((ba.length==Z.length||-1!==da.indexOf(f))&&(Z=Z.map(function(ia,ja){if('object'==typeof ia){if(ba[ja][O]=ba[ja][O]||{},ba[ja][O].__key&&typeof ia[R]==Q)return ia[R]=ba[ja][O].__key,ia;typeof ia[R]==Q&&(ia[R]=O+ja),ba[ja][O].__key=ia[R]}return ia})),ba.length>Z.length)if(0===Z.length||'object'!=typeof Z[0])for(;ba.length>Z.length;)_=ba.pop(),ca=_.parentNode,ca&&t(_);else{var ea=[],fa=Z.map(function(ia){return ia[R]});ba=ba.filter(function(ia){var ka;return(typeof ia[O]==Q?ka=1:(!~fa.indexOf(ia[O].__key)||~ea.indexOf(ia[O].__key))&&(ea.push(ia[O].__key),ka=1),ka)?(t(ia),!1):(ea.push(ia[O].__key),!0)})}}for(var ga=0;ga<ba.length;ga++)if(aa)ba[ga]&&M.run(ba[ga],Z[ga]);else{var ha=j(ba[ga]);Z&&'object'==typeof Z&&(ba[ga][O]=ba[ga][O]||{},Z[R]!==f&&(ba[ga][O].isChildOfArray=!0,ba[ga][O].dataPass=Z[O]),ba[ga][O].xpath=ha),A(ba[ga],Z,ha)}}};var W=function(Y,Z,$,_){var aa=w(Z.parentNode),ba=aa&&aa.getAttribute('key');aa&&ba&&($=+ba.split(O)[1]);var ca=Y($);if(ca&&b.utils.isHTMLEle(ca))return x(Z,ca),Z[O]=Z[O]||{},Z[O].isChildOfArray=!0,Z[O].dataPass={index:$},void(Y.draw&&Y.draw());var da=/<[a-z][\s\S]*>/i.test(ca)?'_html':'_text',ea={};return ea[da]=ca,A(Z,ea,_)},X=[];M.removeNode=t,M.configs=c,M.find=I,M.setId=function(Y){M.id=Y},M.clearCache=function(Y){T[Y]&&delete T[Y]},b.fill=M}(mag,[]),function(b){function f(h,j,l,n){function q(t){return r.has(t)}var r=new WeakSet;return new Proxy(h,{get:function(t,u,v){var w=t[u];if('symbol'==typeof u)return w;if('object'!=typeof w||'symbol'==typeof w||null===w||'function'==typeof w||Array.isArray(w)||!b.utils.isObject(w)||w.then||w.draw)u in t||~b.fill.ignorekeys.indexOf(u.toString())||l||'_'==u[0]||(w=b.proxy({},j,l,n+g+u));else if(!q(w))return r.add(w),b.proxy(w,j,l,n+g+u);var x=j({type:'get',object:t,name:u,path:n,oldValue:Reflect.get(t,u,v)});return'undefined'!=typeof x&&(w=x==b.MAGNUM?void 0:x),w},deleteProperty:function(t,u){return j({type:'delete',name:u,object:t,oldValue:Reflect.get(t,u)}),Reflect.deleteProperty(t,u)},set:function(t,u,v,w){var x=Reflect.get(t,u,w);return x===v&&'length'!==u||(j({type:'set',name:u,object:t,oldValue:x}),Reflect.set(t,u,v,w))}})}var g='/';b.proxy=function(h,j,l,n){for(var q in h){var r=typeof h[q];Array.isArray(h[q])&&101>h[q].length?h[q]=f(h[q],j):'object'==r&&null!==h[q]&&'symbol'!=typeof q&&'symbol'!=r&&'function'!=r&&b.utils.isObject(h[q])&&(h[q]=b.proxy(h[q],j,l,n+g+q))}return f(h,j,l,n||g)}}(mag,window||global||this);
