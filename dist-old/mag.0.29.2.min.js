/*
Mag.JS v0.29.2
http://github.com/magnumjs/mag.js
(c) Michael Glazer
License: MIT
*/
(function(b,f){'use strict';function h(S,T){if(y[S]&&!T)return y[S];var U=mag.doc.getElementById(S);return U&&(y[S]=U),y[S]}var j='KEY',l=0,n=['#'+j,'.'+j,j],o=function(S,T){var U;for(var V in n){var W=n[V].replace(j,T);if(U=S.querySelector(W),U)break}return U},q=function(S){var T=mag.utils.items.getItemVal(S),U=mag.getNode(T);return U},r=function(S){if('string'==typeof S){var T=q(~mag.mod.runningViewInstance||mag.utils.runningEventInstance),U=o(T||mag.doc,S);if(U)return U}return S},t=function(S,T,U){var Z,V=[],W=S.cloneNode(1),Y=[],$=[],_=function(aa){var ba=S;aa=aa||{};var ca;aa.key&&(ca=aa.key+'-'+_.id);var da=aa.key?aa.key+'-'+_.id:_.id;if($[da]||($[da]='object'==typeof U?mag.utils.copy(U):U),'object'==typeof aa&&(aa=mag.utils.extend($[da],aa)),ca&&!V[ca]?ba=V[ca]=W.cloneNode(1):ca&&V[ca]&&(ba=V[ca]),Z&&Z==ba[u].scid)throw Error('MagJS Error - recursive call:'+Z);ba[u]=ba[u]||{},mag._cprops[da]&&'object'==typeof aa&&(aa.children=mag._cprops[da]),_.props=aa,_.key=ca;var ea;if(Y[da]!=mag.utils.toJsonString(aa))try{ea=T(aa),Z=ba[u].scid=da,Y[da]=mag.utils.toJsonString(aa);var fa=mag.fill.id;fa&&fa[u]&&fa[u].scid&&(ba[u].pscid=fa[u].scid),mag.fill.setId(ba),mag.fill.run(ba,ea)}finally{mag.fill.setId(fa),Z=0}return ba};return _.id=++l,_.element=W,_};b.mag=function(S,T,U){if(S=r(S),T=r(T),U=U||{},mag.utils.isHTMLEle(T)&&mag.utils.isHTMLEle(S))T[u]||mag.fill.run(T,S);else{if('function'==typeof T&&mag.utils.isHTMLEle(S)){try{t(S.cloneNode(1),T,U)()}catch(V){}return t(S,T,U)}return K(-1,h(mag._isNode(S)),T,U)}};var u='__magnum__';mag.MAGNUM=u,mag.rafBounceIds=[],mag._cprops=[],mag.doc=f;var w={values:[],attributes:[],elementMatcher:[]},y=[],l=0;mag._isNode=function(S){return mag.utils.isHTMLEle(S)&&(!S.id&&(S.id=++l),y[S.id]=S,S=S.id),S};var z=function(S,T){var U,V=T?S+'-'+T:S;return U=mag.utils.items.isItem(V)?mag.utils.items.getItem(V):mag.utils.getItemInstanceId(V),U};mag.module=function(S,T,U){U=U||{},S=mag._isNode(S);var V=z(S,U.key),W=A(U,V,T,S);return W?K(V,W,T,mag.utils.copy(U)):void 0};var A=function(S,T,U,V){S.retain||mag.mod.clear(T);var W=h(V);if(mag.mod.submodule(V,T,U,S),L(T,V),!Q(T,W))return mag.redraw(W,T,1).then(function(){R(T,W)}),W},B=function(S,T){return 0>T||T!=mag.utils.items.getItem(S)?S==mag.mod.getId(T):!0},C=[];mag.begin=function(S){'undefined'==typeof C[S]?C[S]=1:C[S]++},mag.end=function(S){if(1<C[S])C[S]--;else{C[S]=0;var T=mag.utils.items.getItemVal(S);mag.redraw(h(T),S)}},mag.redraw=function(S,T,U){if(!C[T]){if(!S||'undefined'==typeof T)throw Error('Mag.JS - Id or node invalid: '+mag.utils.items.getItemVal(T));if(!B(S.id,T))return{then:V=>V()};if(U&&mag.fill.configs.splice(0,mag.fill.configs.length),U&&mag.mod.clear(T),mag.mod.runningViewInstance==T)throw Error('Mag.JS - recursive call:'+T);return mag.utils.scheduleFlush(T,M(S,T,U))}},mag.hookin=function(S,T,U){w[S].push({context:{},handler:U,key:T})},mag.hook=function(S,T,U){for(var V=0,W=w[S].length;V<W;V++)mag.utils.callHook(w,T,S,V,U)};var D={},E=[],F=[],G=function(S,T,U){var V=mag.getNode(mag.mod.getId(S)),W=function(){mag.utils.callLCEvent('onunload',mag.mod.getState(S),V,S)||(mag.clear(S),P(S,V),T[S]&&(T[S].length=0),U&&(mag.fill.removeNode(V),mag.mod.remove(S)))};mag.mod.getState(S).onbeforeunload?mag.utils.callLCEvent('onbeforeunload',mag.mod.getState(S),V,S,0,function(){W()}):W()},H=function(S,T){F[S]=F[S]||[];var U=F[S].push(T);return mag.utils.onLCEvent('didupdate',S,function(V,W){var X=[mag.utils.copy(W),mag.utils.copy(V)];if(mag.utils.toJsonString(X)!=mag.utils.toJsonString(E[S])){for(var Y of F[S])Y(V,W,h(mag.mod.getId(S)),E[S]);E[S]=X}}),function(){return F[S].splice(U-1,1)}},I=[],J=function(S,T,U,V,W){var X=mag.utils.items.getItem(T);T=mag._isNode(S);var Y=mag.utils.toJsonString(mag.mod.getProps(X));(R(X,S),!(mag.mod.exists(X)&&mag.utils.callLCEvent('willgetprops',mag.mod.getState(X),S,X,0,U)))&&(mag.mod.submodule(S.id,X,V,U),Y!=mag.utils.toJsonString(mag.mod.getProps(X))&&(W=1),L(X,S.id),Q(X,S)||mag.redraw(S,X,W).then(function(){R(X,S)}))},K=function(S,T,U,V){I[S]=I[S]||[];var W=function(X,Y,Z,$,_){'object'==typeof _&&($=mag.utils.merge(mag.utils.copy($),_),_=0),0>X&&!_&&(_=1);var aa=Y.id+($.key?'.'+$.key+'.':'')+(_||'');!D[aa]||$.key||~W._id||(aa+=++l);var ba=D[aa]=D[aa]||Y.cloneNode(1);if(ba.id=aa,mag.utils.items.isItem(aa))return J(ba,aa,$,Z),ba;var ca=mag.utils.getItemInstanceId(ba.id);return 0>X?X=W._id=ca:I[X].push({instanceId:ca,subscribe:H.bind({},ca)}),J(ba,aa,$,Z),ba}.bind({},S,T,U,V);return W._id=S,W.clones=function(){return I[W._id]},W.destroy=function(X){G(W._id,W.clones,X)},W.getId=function(){return W._id},W.rafBounce=function(X){return X?mag.rafBounceIds[W._id]=1:!1===X&&(mag.rafBounceIds[W._id]=0),!!mag.rafBounceIds[W._id]},W.draw=function(X){return mag.redraw(T,W._id,X)},W.getState=function(){return mag.mod.getState(W._id)},W.getProps=function(){return mag.mod.getProps(W._id)},W.subscribe=function(X){return H(W._id,X)},W},L=function(S,T){var U=function(V,W){h(W)?mag.redraw(h(W),V):mag.utils.items.isItem(W)&&mag.clear(V)}.bind({},S,T);mag.mod.setFrameId(S,U)};mag.clear=function(S){mag.utils.items.removeItem(S),mag.mod.clear(S),mag.fill.clearCache(mag.mod.getId(S))};var M=function(S,T,U){return function(V,W,X){if(h(V.id,1),B(V.id,W)&&V){var Y=mag.mod.getState(W);if(!mag.utils.callLCEvent('isupdate',Y,V,W)){if(mag.mod.iscached(W)&&!X)return 0;if(!mag.utils.callLCEvent('willupdate',Y,V,W)){mag.mod.callView(V,W);var Z=mag.fill.id;mag.fill.setId(V.id),mag.fill.run(V,Y),mag.fill.setId(Z),N(V.id,mag.fill.configs),mag.utils.callLCEvent('didupdate',Y,V,W),X||mag.mod.iscached(W)}}}}.bind({},S,T,U)},N=function(S,T){for(var U in T)U.startsWith('id("'+S+'")/')&&T[U]()},O=function(S){var U=[];for(var V in mag.fill.cached)-1<V.indexOf('id("'+S+'")/')&&-1<V.indexOf('-config')&&mag.fill.cached[V].configContext&&U.push({path:V.split('-config')[0],controller:mag.fill.cached[V].configContext,handler:mag.fill.cached[V].configContext.onunload});return U},P=function(S,T){for(var W,U=O(T.id,S),V=0,X=U;W=X&&X[V];V++)W.controller.onunload&&(W.handler.call(W.controller,T,W.path),W.controller.onunload=0)},Q=function(S,T){return mag.utils.callLCEvent('willload',mag.mod.getState(S),T,S,1)},R=function(S,T){var U=mag.utils.items.getItemVal(S);if(h(U)&&mag.mod.exists(S))return mag.utils.callLCEvent('didload',mag.mod.getState(S),T,S,1)};mag.getNode=h})(window||global||this,document),function(b){'use strict';function f(u,w){var y=u.name;if('undefined'==typeof u.object[u.name]&&'_'!=y[0]){var z=b.fill.find(w,y),A='$'===y[0],B=[];return z.length?(z.forEach(function(G){var H;if(!(G&&G.type&&!~['submit','button'].indexOf(G.type)))'undefined'==typeof u.oldValue&&'undefined'==typeof u.object[u.name]&&G&&!~['submit','button'].indexOf(G.type)&&1==G.childNodes.length&&G.childNodes[0].textContent.trim()&&(H={_text:G.childNodes[0].textContent.trim()});else if(G.value&&0<G.value.length)if('checkbox'!=G.type&&'radio'!=G.type){var K=G.multiple&&[].map.call(G.selectedOptions,L=>L.value);H={_value:K||G.value}}else if(G.checked&&(H={},H._checked=!0),!A){var I=w.querySelectorAll('[name='+G.name+']');if(I.length)for(var J of I)J.checked&&(H?H._value=J.value:H={_value:J.value})}else H?H._value=G.value:H={_value:G.value};H?B.push(H):G&&!G.hasChildNodes()&&B.push(j)}),0===B.length?void 0:A?B:B[0]&&'undefined'!=typeof B[0]._value?B[0]._value:B[0]&&B[0]._text?B[0]._text:B[0]):j}if('_'==y[0]){var C=y.substr(1);if(w.length){var B=[];for(var D in w){var E=w[D],F=E[C];'undefined'==typeof F&&(F=E.getAttribute(C)),B.push(F)}return B}var F=w[C];return'undefined'==typeof F&&(F=w.getAttribute(C)),F}}function g(u,w){return new u(b.proxy({},t.bind({},'state',w)))}var h=[],j=b.MAGNUM,n={runningViewInstance:-1,innerMods:[],cache:[]};n.getState=function(u){return h[u][1]},n.setState=function(u,w){h[u][1]=w},n.getView=function(u){return h[u][0]},n.getProps=function(u){return h[u]&&h[u][2]},n.setProps=function(u,w){return h[u][2]=w},n.remove=function(u){h[u]&&(h[u]=0)},n.getId=function(u){return h[u]&&h[u][3]},n.exists=function(u){return'undefined'!=typeof h[u]},n.setFrameId=function(u,w){h[u][4]=w},n.getFrameId=function(u){return h[u][4]},n.getMod=function(u){return h[u][5]};var o=(u,w)=>{for(var y in w=w||u,u){var z=u[y];'function'!=typeof z||~['controller','view'].indexOf(y)||(u[y]=z.bind(w))}return u};n.submodule=function(u,w,y,z){if(h[w])return z.key&&z.key==n.getProps(w).key?n.setProps(w,b.utils.copy(b.utils.merge(n.getProps(w),z))):n.setProps(w,z),h[w];y=b.utils.copy(y),o(y,y),h[w]=[0,0,0,0,0,0],n.setProps(w,z);var B=function(D,E,F){y.element=F,y.state=E,y.props=n.getProps(D),y.view&&y.view.call(y,E,y.props,F)}.bind({},w),C={controller:function(D){return y.props=n.getProps(w),y.state=D,y.element=b.getNode(u),(y.controller||function(){}).call(D,y.props)||D},view:B};return h[w][0]=C.view,h[w][3]=u,h[w][1]=g(C.controller,w,u),h[w][5]=y,h[w]};var q=[],r=function(u,w){var y=u,z=w.split('/');for(var A of z)if(A){var B=b.fill.find(y,A);B.length&&(y=B)}return y},t=function(u,w,y){if('get'==y.type&&'props'!=u&&!~b.fill.ignorekeys.indexOf(y.name.toString())&&'undefined'==typeof y.oldValue){var z=b.getNode(n.getId(w));if(y.path&&'/'==y.path[0])var A=r(z,y.path);A&&'$'!=y.path.split('/').pop()[0]&&(A=A[0]);var B=f(y,A?A:z);if(null!==B&&'object'==typeof B&&y.object&&b.utils.merge(B,y.object[y.name]),B)return n.cached[w]=0,B}else'set'==y.type&&'props'!=u&&y.object[y.name]&&y.object[y.name].draw&&'function'==typeof y.object[y.name].draw&&(n.innerMods[n.getId(w)]=[y.name,y.object[y.name]]);var C=n.getFrameId(w);'function'==typeof C&&'set'==y.type&&(cancelAnimationFrame(q[w]),q[w]=requestAnimationFrame(C))};n.iscached=function(u){var w=b.utils.toJsonString([n.getProps(u),n.getState(u)]);return u in n.cache&&n.cache[u]==w||void(n.cache[u]=w)},n.clear=function(u){~u&&n.cache[u]&&n.cache.splice(u,1)},n.cached=[],n.callView=function(u,w){n.runningViewInstance=w,n.cached[w]||(b.props.attachToArgs(w,n.getState(w),u),n.cached[w]=1);try{n.getView(w)(n.getState(w),u)}finally{n.runningViewInstance=-1}},b.mod=n}(mag),function(b){'use strict';function g(y,z,A,B){var C=[];for(var D in y){var E=y[D];j(E)&&(C.push(E),h(E,z,A,B))}return!!C.length&&(1==C.length?C[0]:C)}function h(y,z,A,B){if(y[q]=y[q]||{},!y[q].eventOnFocus){var C=function(D,E,F){var H=~['radio','checkbox'].indexOf(y.type);if(this[q].dirty||(this[q].dirty=1),y.selectedOptions)var I=[].map.call(y.selectedOptions,J=>J.value);H?'_checked'in E||o in E?E._checked=this.checked:this.checked&&(E[F]=this.value):void 0===E[o]?void 0!==E._text&&(E._text=I||this.value):E[o]=I||this.value,b.redraw(D,b.utils.items.getItem(D.id))}.bind(y,B,z,A);y.addEventListener('click',C),y.addEventListener('input',C),y.addEventListener('change',C),y.addEventListener('focus',C),y[q].eventOnFocus=1}}function j(y){return y&&~['INPUT','SELECT','TEXTAREA'].indexOf(y.tagName)}function l(y){for(var z in y)if(j(y[z]))return y[z];return!1}var n={},o='_value',q=b.MAGNUM,r=function(y,z){for(var A=1;A<y.length;A++){var B=y[A],C=y[A+1],D=b.fill.find(Array.isArray(z)?z[0]:z,B);if(C&&!isNaN(+C))z=D[C];else if(D&&D.length&&C&&A+2<y.length)z=b.fill.find(D[0],C);else if(D&&D.length&&(z=D,A+2==y.length))break}return Array.isArray(z)?z[0]:z},t=function(y,z,A,B){var D,C=A.toString().split('.');if(3<=C.length)B=r(C,B),D=b.fill.find(B,z);else{var E=parseInt(C.pop()),F=isNaN(E)?0:E;D=b.fill.find(B[F]?B[F]:B,z)}return g(D,y,z,B)},u=function(y,z,A,B){var C=A[z];~[o,'_checked','_text'].indexOf(z)&&'string'==typeof y&&(z=y.split('.').pop());var D=b.fill.find(B,z),E=l(D);if('function'!=typeof C&&E){var F=t.bind({},A,z,y,B);F(),Object.defineProperty(A,z,{configurable:!0,get:function(){var G=F();return G&&'undefined'!==G.value&&G[q]&&G[q].dirty&&G.value!==C?(C=G.value,b.redraw(B,y,1),G.value):C},set:function(G){var H=F();H&&'undefined'!==H.value&&H.value!==G&&G!==C&&(H.value=G,C=G)}})}},w=function(y,z,A){for(var B in z)if(z.hasOwnProperty(B)){var C=z[B];B==o||'object'!=typeof C||b.utils.isHTMLEle(C)?u.bind({},y,B,z,A)():(b.utils.isObject(C)&&b.utils.isEmpty(C)&&(C[o]=''),w(y+'.'+B,C,A))}};n.attachToArgs=w,b.props=n}(mag),function(b){'use strict';var f={};f.copy=o=>Object.assign({},o),f.merge=function(){return Object.assign.apply({},arguments)},f.extend=function(o,q,r){for(var t in q)if(q[t]===void 0)delete q[t];else if(r&&f.isObject(q[t]))return f.extend(o[t],q[t]);return f.merge(o,q)},f.isObject=o=>'Object]'==Object.prototype.toString.call(o).substr(-7);var g=(o,q)=>'function'==typeof q?''+q:q;f.toJsonString=o=>JSON.stringify(o,g),f.isEmpty=o=>{for(var q in o)if(o.hasOwnProperty(q))return 0;return 1},f.isHTMLEle=o=>o&&1===o.nodeType,f.callHook=function(o,q,r,t,u,w){o[r][t].key==q&&(w={v:u.value,k:u.key},u.change=!1,o[r][t].handler.call(o[r][t].context,u),{v:u.value,k:u.key}!==w&&(u.change=!0))};var h=[],j=[];f.scheduleFlush=function(o,q){return new Promise(function(r){b.rafBounce||b.rafBounceIds[o]?(cancelAnimationFrame(j[o]),j[o]=requestAnimationFrame(function(){q(),r(),j[o]=0})):(h.push(q),j[o]?r():j[o]=requestAnimationFrame(function(){j[o]=0;for(var t;t=h.shift();)t();r()}))})};var l=[];f.onLCEvent=function(o,q,r){var t=o+'-'+q;l[t]=l[t]||[];var u=l[t].push(r);return function(){return l[t].splice(u-1,1)}},f.callLCEvent=function(o,q,r,t,u,w){var y;f.runningEventInstance=t;var z=b.mod.getProps(t),A=b.mod.getMod(t),B=A[o]?A:q[o]&&q;B&&(y=B[o].call(A,r,z,t,w),u&&(B[o]=0));var C=o+'-'+t;if(l[C]){for(var D of l[C])D(q,z);u&&(l[C]=0)}return(f.runningEventInstance=-1,!1===y)||void 0};var n={i:[],isItem:o=>~n.i.indexOf(o),setItem:o=>n.i[n.i.length]=o,getItem:o=>n.i.indexOf(o),getItemVal:o=>n.i[o],removeItem:o=>n.i.splice(n.i.indexOf(o),1)};f.items=n,f.getItemInstanceIdAll=()=>n.i,f.getItemInstanceId=o=>{return n.isItem(o)?n.getItem(o):(n.setItem(o),n.getItem(o))},b.utils=f}(mag),function(b,f,g){'use strict';function h(ea){return Array.isArray(ea)}function j(ea,fa){return ea[W]=ea[W]||{},(!ea[W].uid||fa)&&(ea[W].uid=++ba),ea[W].uid}function n(ea,fa,ga){var ha=j(ea,ga);return _[U.id]=_[U.id]||[],_[U.id][ha]&&_[U.id][ha]==fa?1:void(_[U.id][ha]=fa)}function o(ea){return ea.id&&b.utils.items.isItem(ea.id)?ea:ea.parentNode?o(ea.parentNode):void 0}function q(ea,fa){if(ea[W]&&ea[W].scid&&!ea[W].pscid)fa=ea;else if(fa)return fa;return ea.parentNode?q(ea.parentNode,fa):void 0}function r(ea){var fa='',ga=o(ea),ha=ea.parentNode&&[].indexOf.call(ea.parentNode.children,ea);return ga&&(fa+='id("'+(ga.id||ga.tagName)+'")'),fa+='/'+ea.tagName+'['+(ha+1)+']',fa}function t(ea){if(ea.id&&U.id===ea.id||U.id===ea)return'id("'+(ea.id||ea.tagName)+'")';if(ea===b.doc.body)return ea.tagName;var fa=0;if(ea.parentNode)for(var ia,ga=ea.parentNode.childNodes,ha=0;ha<ga.length;ha++){if(ia=ga[ha],ia===ea)return t(ea.parentNode)+(ea.tagName?'/'+ea.tagName+'['+(fa+1)+']':'');1===ia.nodeType&&ia.tagName===ea.tagName&&fa++}}function u(ea){var fa=t(ea);ea&&V[fa+'-config']&&V[fa+'-config'].configContext&&typeof V[fa+'-config'].configContext.onunload==='function'&&(V[fa+'-config'].configContext.onunload(V[fa+'-config'].configContext,ea,fa),delete V[fa+'-config'],delete U.configs[fa]),ea.parentNode&&ea.parentNode.removeChild(ea),b.mod.cached[b.utils.items.getItem(U.id)]=0}function w(ea){var fa=ea&&parseInt(ea.split('[').pop().slice(0,-1));return fa?parseInt(fa)-1:0}function y(ea){var fa=[];return ea.replace(/\[(.+?)\]/g,function(ga,ha){fa.push(ha)}),fa}function z(ea){return ea&&~ea.indexOf('id(')&&ea.split('id("')[1].split('")')[0]}function A(ea,fa,ga){var ha=j(ea),ia=+ga==+ga?fa+ga:fa,ja='object'==typeof U.id?U.id.tagName:U.id,ka='string'==typeof ga?ga.split(ja)[1]:'',la=ja+ka+'/'+ea.tagName+'['+ia+']';return la}function B(ea){if(ea&&ea[W]&&ea[W].isChildOfArray)return ea;return ea.parentNode?B(ea.parentNode):void 0}function C(ea,fa,ga){if(!n(ea,fa.outerHTML,ga)&&(!fa.id&&!ea.childNodes[0]||fa.id&&!b.doc.getElementById(fa.id)||ea.firstChild&&!ea.firstChild.isEqualNode(fa))){var ha=b.utils.items.getItem(fa.id);if(~ha&&ea.hasChildNodes()){var ia=b.utils.items.getItem(U.id),ja=ea.cloneNode(1);ja[W]={childof:ia},b.mod.getProps(ha).children=ja}else fa[W]&&fa[W].scid&&(ja=ea.cloneNode(1),ja[W]={childof:fa[W].scid},b._cprops[fa[W].scid]=ja);for(;ea.lastChild;)ea.removeChild(ea.lastChild);if(fa[W]&&fa[W].childof!==g){ea.innerHTML=fa.innerHTML;var ka=fa[W].childof;b._cprops[ka]||(D(ea,ka),b.utils.onLCEvent('willupdate',ka,()=>{D(ea,ka)}))}else ea.appendChild(fa)}}function D(ea,fa){var ga=U.id;U.setId(b.mod.getId(fa)),U.run(ea,b.mod.getState(fa)),U.setId(ga)}function E(ea,fa){var ga;for(var ha in fa){var ia=fa[ha];ia===g?ia='':null===ia&&-1===['onunload'].indexOf(ha)?(ea[W].detached=ea[W].detached||[],ea[W].detached[ha]=1,I(ea,ha)):ea[W].detached&&ea[W].detached[ha]&&(H(ea,ha),ea[W].detached[ha]=0),'_'===ha[0]&&'_'!==ha[1]&&(ga=ga||{},ga[ha.substr(1)]=ia)}return ga}function F(ea,fa,ga){var ha;for(var ia in fa){var ja=fa[ia];if(!~U.ignorekeys.indexOf(ia)&&'_'!==ia[0]){ha=Q(ea,ia);var ka={key:ia,value:ja,node:ea};b.hook('values','*',ka),ka.change&&(ja=ka.value),U.run(ha,ja,ga+'/'+ia)}}}function G(ea,fa,ga,ha){var ia,ma=w(ga);return fa&&b.utils.isHTMLEle(fa)?void C(ea,fa):'function'==typeof fa?ca(fa,ea,ma,ga):'object'==typeof fa?void(b.mod.innerMods[U.id]&&fa[b.mod.innerMods[U.id][0]]&&!fa[b.mod.innerMods[U.id][0]].draw&&b.mod.innerMods[U.id][1].destroy(),ia=E(ea,fa),ia&&N(ea,ia,ga,ha),F(ea,fa,ga)):G(ea,{_text:fa},ga)}function H(ea,fa){var ga=Q(ea,fa);ga.forEach(function(ha){var ia=j(ha);if(ia in da){for(var ja in da[ia])ha.appendChild(da[ia][ja]);delete da[ia]}})}function I(ea,fa){var ga=0,ha=1,ia=function(la){if(++ga==ha)for(;la.lastChild;)u(la.lastChild)},ja=function(la,ma){var na;la.id&&b.utils.items.isItem(la.id)&&(na=b.utils.items.getItem(la.id)),na&&b.mod.getState(na).onbeforeunload?(ha++,b.utils.callLCEvent('onbeforeunload',b.mod.getState(na),la,na,0,function(){na&&b.utils.callLCEvent('onunload',b.mod.getState(na),la,na),ma()})):(na&&b.utils.callLCEvent('onunload',b.mod.getState(na),la,na),ma())},ka=Q(ea,fa);ka.forEach(function(la){var ma=j(la);la.children.length&&(da[ma]=J(la.children));for(var oa in da[ma]){var pa=da[ma][oa];ja(pa,function(){ia(la)})}ia(la)})}function J(ea){var fa;if(null==ea.length&&(ea=[ea]),!h(ea)){fa=[];for(var ga=0;ga<ea.length;ga+=1)ea[ga]&&fa.push(ea[ga]);ea=fa}return ea}function K(ea,fa){var ga=function(ha,ia,ja){var ka=r(ia),la=z(ka);la||(la=q(ia));var ma=U.id;U.setId(la);var na=B(ia),oa=na&&t(na),pa=w(oa),ka=ka,qa=w(ka),ra={path:oa,node:na,data:((na||{})[W]||[]).dataPass,index:pa};U.setId(ma);var sa=b.doc.getElementById(la),ta=b.utils.items.getItem(la),ua=ha.call(~ta?b.mod.getMod(ta):sa,ja,qa,ia,ra);if(la&&sa){var va=function(){b.redraw(sa,ta,1)};ua&&ua.then?ua.then(function(wa){return va(),wa}):va()}return ua}.bind({},fa,ea);return ga}function L(ea,fa){function ga(ha){var ia=ea[W].eventHandlers[fa];for(var ja in ia){var ka=ia[ja],la=K(ea,ka),ma=la(ha);!1===ma&&ha.preventDefault()}}ea.removeEventListener(fa,ga),ea.addEventListener(fa,ga)}function M(ea,fa,ga,ha){var ia=fa.substr(2).toLowerCase(),ja=('string'==typeof ha?ha.split('/')[0]:'')+'-'+ga[W].uid,ka=ga[W].events=ga[W].events||[],la=ga[W].eventHandlers=ga[W].eventHandlers||[];la[ia]=la[ia]||[],la[ia][ja]=ea,ka[ia]||(ka[ia]=1,L(ga,ia))}function N(ea,fa,ga,ha){var ia=w(ga);for(var ja in V[j(ea)]=V[j(ea)]||[],fa)if('text'!==ja&&'html'!==ja)if(0==ja.indexOf('on'))M(fa[ja],ja,ea,ha);else{if('config'==ja){var ga=t(ea),ia=w(ga),ka=!0;V[ga+'-config']?ka=!1:V[ga+'-config']={};var la=V[ga+'-config'].configContext=V[ga+'-config'].configContext||{},ma=function(qa,ra){return function(){return qa.apply(qa,ra)}};f[ga]=ma(fa[ja],[ea,ka,la,ia]);continue}var na={key:ja,value:fa[ja],node:ea};if(b.hook('attributes',ja,na),na.change&&(ja=na.key,fa[ja]=na.value),V[j(ea)]&&V[j(ea)][ja]==fa[ja])continue;null===fa[ja]?ea.removeAttribute(ja):'value'==ja&&ea.multiple&&ea.selectedOptions&&Array.isArray(fa[ja])?(ea.value=fa[ja],fa[ja].forEach(function(qa){Array.from(ea.options).find(ra=>ra.value==qa).selected=!0})):ja in ea?'style'==ja?ea[ja].cssText=fa[ja]:ea[ja]=fa[ja]:ea.setAttribute(ja,fa[ja]+''),V[j(ea)][ja]=fa[ja]}O(ea,fa.text),P(ea,fa.html)}function O(ea,fa){if(ea&&null!=fa&&!n(ea,fa)){var ga=fa+'';if('INPUT'!==ea.nodeName)'SELECT'!==ea.nodeName&&(ea.firstChild?ea.firstChild.textContent=ga:ea.appendChild(ea.ownerDocument.createTextNode(ga)));else if(!~['radio','checkbox'].indexOf(ea.type))ga!=ea.value&&(ea.value=ga);else if(ea.name){var ha=b.getNode(U.id).querySelectorAll('[name='+ea.name+']');if(1<ha.length)for(var ia of ha)if(ia.value==ga){ia.checked=!0;break}}'SELECT'===ea.nodeName&&ga&&(ea.value=ga)}}function P(ea,fa){var ga='';if(Array.isArray(fa)){for(var ha in fa)n(fa[ha],fa[ha].outerHTML)||(ea.children[ha]?ea.replaceChild(fa[ha],ea.children[ha]):ea.appendChild(fa[ha]));return}return b.utils.isHTMLEle(fa)?(ga=fa.outerHTML,n(ea,ga))?void 0:void ea.appendChild(fa):void(!ea||null==fa||n(ea,fa)||(ea.innerHTML=fa))}function Q(ea,fa,ga){var ha=S(ea),ia=[],ja=fa,ka='$'===fa[0];'$'===ja[0]&&(ja=ja.substr(1));for(var la=0;la<ha.length;la+=1)T(ha[la],ja)&&ia.push(ha[la]);if(!ia.length||ka)for(var la=0;la<ha.length&&(ia=ia.concat(Q(ha[la],fa,!0)),!ia.length||ka);la++);if(!ga&&!ia.length){var ma={key:fa,value:ia,node:ea};b.hook('elementMatcher',fa,ma),ma.change&&(ia=ma.value)}return ia}function R(ea){return U.id&&(b.utils.isHTMLEle(U.id)&&ea[W]&&ea[W].scid||ea.id&&ea.id!=U.id&&b.utils.items.isItem(ea.id))?0:1}function S(ea){var fa=[];if(ea){var ga=ea.childNodes;if(ga)for(var ha=0;ha<ga.length;ha+=1)1===ga[ha].nodeType&&R(ga[ha])&&fa.push(ga[ha])}return fa}function T(ea,fa){var ga=' '+ea.className+' ';return ea.id===fa||~ga.indexOf(' '+fa+' ')||ea.name===fa||ea.nodeName.toLowerCase()===fa.toLowerCase()||ea.getAttribute('data-bind')===fa}var U={cached:[],ignorekeys:['toString','draw','then','hasOwnProperty','willgetprops','onbeforeunload','Symbol(Symbol.toStringTag)','nodeType','toJSON','onunload','willupdate','didupdate','didload','willload','isupdate']},V=U.cached,W=b.MAGNUM,Y='undefined',Z='_key',$=[],_=[],aa={},ba=0;U.run=function(ea,fa,ga){var ha,ia;if(ea){null==fa&&(fa={_text:''});var ja=J(ea);if(ia=h(fa),ia){if(aa[ga]&&0===ja.length&&(aa[ga].parent.insertAdjacentHTML('beforeend',aa[ga].node),ja=J(aa[ga].parent.children)),!ja.length)return;var ka=ja[0].parentNode;aa[ga]||(aa[ga]={node:ja[0].cloneNode(1).outerHTML,parent:ka});for(var la=b.doc.createDocumentFragment();ja.length<fa.length;)aa[ga]?(ka.insertAdjacentHTML('beforeend',aa[ga].node),ha=ka.lastChild):ha=ja[0].cloneNode(1),ja.push(ha),ka&&la.appendChild(ha);ka.appendChild(la);var ma=fa.map(function(ra){return ra&&ra[Z]});if((ja.length==fa.length||-1!==ma.indexOf(g))&&(fa=fa.map(function(ra,sa){if('object'==typeof ra){if(ja[sa][W]=ja[sa][W]||{},ja[sa][W].__key&&typeof ra[Z]==Y)return ra[Z]=ja[sa][W].__key,ra;typeof ra[Z]==Y&&(ra[Z]=W+sa),ja[sa][W].__key=ra[Z]}return ra})),ja.length>fa.length)if(0===fa.length||'object'!=typeof fa[0])for(;ja.length>fa.length;)ha=ja.pop(),ka=ha.parentNode,ka&&u(ha);else{var na=[],oa=fa.map(function(ra){return ra[Z]});ja=ja.filter(function(ra){var ta;return(typeof ra[W]==Y?ta=1:(!~oa.indexOf(ra[W].__key)||~na.indexOf(ra[W].__key))&&(na.push(ra[W].__key),ta=1),ta)?(u(ra),!1):(na.push(ra[W].__key),!0)})}}for(var pa=0;pa<ja.length;pa++)if(ia)ja[pa]&&U.run(ja[pa],fa[pa],pa);else{var qa=A(ja[pa],pa+1,ga);fa&&'object'==typeof fa&&fa.hasOwnProperty(Z)&&(ja[pa][W].isChildOfArray=!0,!b.utils.isHTMLEle(fa)&&(ja[pa][W].dataPass=fa)),ja[pa][W].xpath=qa,G(ja[pa],fa,qa,ga)}}};var ca=function(ea,fa,ga,ha){'object'==typeof U.id&&(ha=t(fa.parentNode)+ha),ga=y(ha);var ia=ea(ga.join('.'),ha);return ia&&b.utils.isHTMLEle(ia)?void(C(fa,ia),fa[W]=fa[W]||{},fa[W].isChildOfArray=!0,fa[W].dataPass={index:ga},ea.draw&&ea.draw()):G(fa,ia,ha)},da=[];U.removeNode=u,U.configs=f,U.find=Q,U.setId=ea=>{U.id=ea},U.clearCache=ea=>{_[ea]&&delete _[ea]},b.fill=U}(mag,[]),function(b){function g(j,l,n,o){function q(t){return r.has(t)}var r=new WeakSet;return new Proxy(j,{get:function(t,u,w){var y=t[u];if('symbol'==typeof u)return y;if('object'!=typeof y||'symbol'==typeof y||null===y||'function'==typeof y||Array.isArray(y)||!b.utils.isObject(y)||y.then||y.draw)u in t||~b.fill.ignorekeys.indexOf(u.toString())||n||'_'==u[0]||(y=b.proxy({},l,n,o+h+u));else if(!q(y))return r.add(y),b.proxy(y,l,n,o+h+u);var z=l({type:'get',object:t,name:u,path:o,oldValue:Reflect.get(t,u,w)});return'undefined'!=typeof z&&(y=z==b.MAGNUM?void 0:z),y},deleteProperty:function(t,u){return l({type:'delete',name:u,object:t,oldValue:Reflect.get(t,u)}),Reflect.deleteProperty(t,u)},set:function(t,u,w,y){var z=Reflect.get(t,u,y);return z===w&&'length'!==u||(l({type:'set',name:u,object:t,oldValue:z}),Reflect.set(t,u,w,y))}})}var h='/';b.proxy=function(j,l,n,o){for(var q in j){var r=typeof j[q];Array.isArray(j[q])&&101>j[q].length?j[q]=g(j[q],l):'object'==r&&null!==j[q]&&'symbol'!=typeof q&&'symbol'!=r&&'function'!=r&&b.utils.isObject(j[q])&&(j[q]=b.proxy(j[q],l,n,o+h+q))}return g(j,l,n,o||h)}}(mag,window||global||this);
