/*
Mag.JS v0.28.3
http://github.com/magnumjs/mag.js
(c) Michael Glazer
License: MIT
*/
(function(b,c){'use strict';function g(P,Q){if(v[P]&&!Q)return v[P];var R=mag.doc.getElementById(P);return R&&(v[P]=R),v[P]}var h='KEY',j=0,l=['#'+h,'.'+h,h],n=function(P,Q){var R;for(var S in l){var T=l[S].replace(h,Q);if(R=P.querySelector(T),R)break}return R},o=function(P){var Q=mag.utils.items.getItemVal(P),R=mag.getNode(Q);return R},q=function(P){if('string'==typeof P){var Q=o(~mag.mod.runningViewInstance||mag.utils.runningEventInstance),R=n(Q||mag.doc,P);if(R)return R}return P},r=function(P,Q,R){var W,S=[],T=P.cloneNode(1),V=[],X=[],Y=function(Z){var $=P;Z=Z||{};var _;Z.key&&(_=Z.key+'-'+Y.id);var aa=Z.key?Z.key+'-'+Y.id:Y.id;if(X[aa]||(X[aa]='object'==typeof R?mag.utils.copy(R):R),'object'==typeof Z&&(Z=mag.utils.extend(X[aa],Z)),_&&!S[_]?$=S[_]=T.cloneNode(1):_&&S[_]&&($=S[_]),W&&W==$[t].scid)throw Error('MagJS Error - recursive call:'+W);$[t]=$[t]||{},mag._cprops[aa]&&'object'==typeof Z&&(Z.children=mag._cprops[aa]);var ba;return V[aa]!=mag.utils.toJsonString(Z)&&(ba=Q(Z),W=$[t].scid=aa,V[aa]=mag.utils.toJsonString(Z),mag.fill.setId($),mag.fill.run($,ba),mag.fill.setId(0),W=0),$};return Y.id=++j,Y};b.mag=function(P,Q,R){if(P=q(P),Q=q(Q),R=R||{},mag.utils.isHTMLEle(Q)&&mag.utils.isHTMLEle(P))Q[t]||mag.fill.run(Q,P);else{if('function'==typeof Q&&mag.utils.isHTMLEle(P)){try{r(P.cloneNode(1),Q,R)()}catch(S){}return r(P,Q,R)}return H(-1,g(mag._isNode(P)),Q,R)}};var t='__magnum__';mag.MAGNUM=t,mag.rafBounceIds=[],mag._cprops=[],mag.doc=c;var u={values:[],attributes:[],elementMatcher:[]},v=[],j=0;mag._isNode=function(P){return mag.utils.isHTMLEle(P)&&(!P.id&&(P.id=++j),v[P.id]=P,P=P.id),P};var w=function(P,Q){var R,S=Q?P+'-'+Q:P;return R=mag.utils.items.isItem(S)?mag.utils.items.getItem(S):mag.utils.getItemInstanceId(S),R};mag.module=function(P,Q,R){R=R||{},P=mag._isNode(P);var S=w(P,R.key),T=x(R,S,Q,P);return T?H(S,T,Q,mag.utils.copy(R)):void 0};var x=function(P,Q,R,S){P.retain||mag.mod.clear(Q);var T=g(S);if(mag.mod.submodule(S,Q,R,P),I(Q,S),!N(Q,T))return mag.redraw(T,Q,1).then(function(){O(Q,T)}),T},y=function(P,Q){return 0>Q||Q!=mag.utils.items.getItem(P)?P==mag.mod.getId(Q):!0},z=[];mag.begin=function(P){'undefined'==typeof z[P]?z[P]=1:z[P]++},mag.end=function(P){if(1<z[P])z[P]--;else{z[P]=0;var Q=mag.utils.items.getItemVal(P);mag.redraw(g(Q),P)}},mag.redraw=function(P,Q,R){if(!z[Q]){if(!P||'undefined'==typeof Q)throw Error('Mag.JS - Id or node invalid: '+mag.utils.items.getItemVal(Q));if(!y(P.id,Q))return{then:S=>S()};if(R&&mag.fill.configs.splice(0,mag.fill.configs.length),R&&mag.mod.clear(Q),mag.mod.runningViewInstance==Q)throw Error('Mag.JS - recursive call:'+Q);return mag.utils.scheduleFlush(Q,J(P,Q,R))}},mag.hookin=function(P,Q,R){u[P].push({context:{},handler:R,key:Q})},mag.hook=function(P,Q,R){for(var S=0,T=u[P].length;S<T;S++)mag.utils.callHook(u,Q,P,S,R)};var A={},B=[],C=[],D=function(P,Q,R){var S=mag.getNode(mag.mod.getId(P)),T=function(){mag.utils.callLCEvent('onunload',mag.mod.getState(P),S,P)||(mag.clear(P),M(P,S),Q[P]&&(Q[P].length=0),R&&(mag.fill.removeNode(S),mag.mod.remove(P)))};mag.mod.getState(P).onbeforeunload?mag.utils.callLCEvent('onbeforeunload',mag.mod.getState(P),S,P,0,function(){T()}):T()},E=function(P,Q){C[P]=C[P]||[];var R=C[P].push(Q);return mag.utils.onLCEvent('didupdate',P,function(S,T){var U=mag.utils.merge(mag.utils.copy(T),mag.utils.copy(S));if(mag.utils.toJsonString(U)!=mag.utils.toJsonString(B[P])){for(var V of C[P])V(S,T,g(mag.mod.getId(P)),B[P]);B[P]=U}}),function(){return C[P].splice(R-1,1)}},F=[],G=function(P,Q,R,S,T){var U=mag.utils.items.getItem(Q);(Q=mag._isNode(P),O(U,P),!(mag.mod.exists(U)&&mag.utils.callLCEvent('willgetprops',mag.mod.getState(U),P,U,0,R)))&&(mag.mod.submodule(P.id,U,S,R),I(U,P.id),N(U,P)||mag.redraw(P,U,T).then(function(){O(U,P)}))},H=function(P,Q,R,S){F[P]=F[P]||[];var T=function(U,V,W,X,Y){'object'==typeof Y&&(X=mag.utils.merge(mag.utils.copy(X),Y),Y=0);var Z=V.id+(X.key?'.'+X.key+'.':'')+(Y||'');!A[Z]||X.key||~T._id||(Z+=++j);var $=A[Z]=A[Z]||V.cloneNode(1);if($.id=Z,mag.utils.items.isItem(Z))return G($,Z,X,W,1),$;var _=mag.utils.getItemInstanceId($.id);return 0>U?U=T._id=_:F[U].push({instanceId:_,subscribe:E.bind({},_)}),G($,Z,X,W,1),$}.bind({},P,Q,R,S);return T._id=P,T.clones=function(){return F[T._id]},T.destroy=function(U){D(T._id,T.clones,U)},T.getId=function(){return T._id},T.rafBounce=function(U){return U?mag.rafBounceIds[T._id]=1:!1===U&&(mag.rafBounceIds[T._id]=0),!!mag.rafBounceIds[T._id]},T.draw=function(U){return mag.redraw(Q,T._id,U)},T.getState=function(){return mag.mod.getState(T._id)},T.getProps=function(){return mag.mod.getProps(T._id)},T.subscribe=function(U){return E(T._id,U)},T},I=function(P,Q){var R=function(S,T){g(T)?mag.redraw(g(T),S):mag.utils.items.isItem(T)&&mag.clear(S)}.bind({},P,Q);mag.mod.setFrameId(P,R)};mag.clear=function(P){mag.utils.items.removeItem(P),mag.mod.clear(P),mag.fill.clearCache(mag.mod.getId(P))};var J=function(P,Q,R){return function(S,T,U){if(g(S.id,1),y(S.id,T)&&S){var V=mag.mod.getState(T);return mag.utils.callLCEvent('isupdate',V,S,T)?void 0:mag.mod.iscached(T)&&!U?0:void(mag.utils.callLCEvent('willupdate',V,S,T)||(mag.mod.callView(S,T),mag.fill.setId(S.id),mag.fill.run(S,V),mag.fill.setId(0),K(S.id,mag.fill.configs),mag.utils.callLCEvent('didupdate',V,S,T),!U&&mag.mod.iscached(T)))}}.bind({},P,Q,R)},K=function(P,Q){for(var R in Q)R.startsWith('id("'+P+'")/')&&Q[R]()},L=function(P){var R=[];for(var S in mag.fill.cached)-1<S.indexOf('id("'+P+'")/')&&-1<S.indexOf('-config')&&mag.fill.cached[S].configContext&&R.push({path:S.split('-config')[0],controller:mag.fill.cached[S].configContext,handler:mag.fill.cached[S].configContext.onunload});return R},M=function(P,Q){for(var T,R=L(Q.id,P),S=0,U=R;T=U&&U[S];S++)T.controller.onunload&&(T.handler.call(T.controller,Q,T.path),T.controller.onunload=0)},N=function(P,Q){return mag.utils.callLCEvent('willload',mag.mod.getState(P),Q,P,1)},O=function(P,Q){var R=mag.utils.items.getItemVal(P);if(g(R)&&mag.mod.exists(P))return mag.utils.callLCEvent('didload',mag.mod.getState(P),Q,P,1)};mag.getNode=g})(window||global||this,document),function(b){'use strict';function c(t,u){var v=t.name;if('undefined'==typeof t.object[t.name]&&'_'!=v[0]){var w=b.fill.find(u,v),x='$'===v[0],y=[];return w.length?(w.forEach(function(D){var E;if(!(D&&D.type&&!~['submit','button'].indexOf(D.type)))'undefined'==typeof t.oldValue&&'undefined'==typeof t.object[t.name]&&D&&!~['submit','button'].indexOf(D.type)&&1==D.childNodes.length&&D.childNodes[0].textContent.trim()&&(E={_text:D.childNodes[0].textContent.trim()});else if(D.value&&0<D.value.length)if('checkbox'!=D.type&&'radio'!=D.type)E={_value:D.value};else if(D.checked&&(E={},E._checked=!0),!x){var F=u.querySelectorAll('[name='+D.name+']');if(F.length)for(var G of F)G.checked&&(E?E._value=G.value:E={_value:G.value})}else E?E._value=D.value:E={_value:D.value};E?y.push(E):D&&!D.hasChildNodes()&&y.push(h)}),0===y.length?void 0:x?y:y[0]&&'undefined'!=typeof y[0]._value?y[0]._value:y[0]&&y[0]._text?y[0]._text:y[0]):h}if('_'==v[0]){var z=v.substr(1);if(u.length){var y=[];for(var A in u){var B=u[A],C=B[z];'undefined'==typeof C&&(C=B.getAttribute(z)),y.push(C)}return y}var C=u[z];return'undefined'==typeof C&&(C=u.getAttribute(z)),C}}function f(t,u){l.setProps(u,b.proxy(l.getProps(u),r.bind({},'props',u),'prop'));var w=new t(b.proxy({},r.bind({},'state',u)));return w}var g=[],h=b.MAGNUM,l={runningViewInstance:-1,innerMods:[],cache:[]};l.getState=function(t){return g[t][1]},l.setState=function(t,u){g[t][1]=u},l.getView=function(t){return g[t][0]},l.getProps=function(t){return g[t][2]},l.setProps=function(t,u){return g[t][2]=u},l.remove=function(t){g.splice(t,1)},l.getId=function(t){return g[t]&&g[t][3]},l.exists=function(t){return'undefined'!=typeof g[t]},l.setFrameId=function(t,u){g[t][4]=u},l.getFrameId=function(t){return g[t][4]},l.getMod=function(t){return g[t][5]};var n=(t,u)=>{for(var v in u=u||t,t){var w=t[v];'function'!=typeof w||~['controller','view'].indexOf(v)||(t[v]=w.bind(u))}return t};l.submodule=function(t,u,v,w){if(g[u])return w.key&&w.key==l.getProps(u).key?l.setProps(u,b.utils.copy(b.utils.merge(l.getProps(u),w))):l.setProps(u,w),g[u];v=b.utils.copy(v),n(v,v),g[u]=[0,0,0,0,0,0],l.setProps(u,w);var y=function(A,B,C){v.element=C,v.state=B,v.props=l.getProps(A),v.view&&v.view.call(v,B,v.props,C)}.bind({},u),z={controller:function(A){return v.props=l.getProps(u),v.state=A,v.element=b.getNode(t),(v.controller||function(){}).call(A,v.props)||A},view:y};return g[u][0]=z.view,g[u][3]=t,g[u][1]=f(z.controller,u,t),g[u][5]=v,g[u]};var o=[],q=function(t,u){var v=t,w=u.split('/');for(var x of w)if(x){var y=b.fill.find(v,x);y.length&&(v=y)}return v},r=function(t,u,v){if('get'==v.type&&'props'!=t&&!~b.fill.ignorekeys.indexOf(v.name.toString())&&'undefined'==typeof v.oldValue){var w=b.getNode(l.getId(u));if(v.path&&'/'==v.path[0])var x=q(w,v.path);x&&'$'!=v.path.split('/').pop()[0]&&(x=x[0]);var y=c(v,x?x:w);if(null!=y&&'undefined'!=typeof y&&'object'==typeof y&&v.object&&b.utils.merge(y,v.object[v.name]),'undefined'!=typeof y)return l.cached[u]=0,y}else'set'==v.type&&'props'!=t&&v.object[v.name]&&v.object[v.name].draw&&'function'==typeof v.object[v.name].draw&&(l.innerMods[l.getId(u)]=[v.name,v.object[v.name]]);var z=l.getFrameId(u);'function'==typeof z&&'set'==v.type&&(cancelAnimationFrame(o[u]),o[u]=requestAnimationFrame(z))};l.iscached=function(t){var u=b.utils.toJsonString(b.utils.merge(b.utils.copy(l.getProps(t)),l.getState(t)));return t in l.cache&&l.cache[t]==u||void(l.cache[t]=u)},l.remove=function(t){g[t]&&(g[t]=0)},l.clear=function(t){~t&&l.cache[t]&&l.cache.splice(t,1)},l.cached=[],l.callView=function(t,u){l.runningViewInstance=u,l.cached[u]||(b.props.attachToArgs(u,l.getState(u),t),l.cached[u]=1);try{l.getView(u)(l.getState(u),t)}finally{l.runningViewInstance=-1}},b.mod=l}(mag),function(b){'use strict';function f(u,v,w,x){var y=[];for(var z in u){var A=u[z];h(A)&&(y.push(A),g(A,v,w,x))}return!!y.length&&(1==y.length?y[0]:y)}function g(u,v,w,x){if(u[n]=u[n]||{},!u[n].eventOnFocus){var y=function(z,A,B){var D=~['radio','checkbox'].indexOf(u.type);this[n].dirty||(this[n].dirty=1),D?'_checked'in A||'_value'in A?A._checked=this.checked:this.checked&&(A[B]=this.value):void 0===A._value?void 0!==A._text&&(A._text=this.value):A._value=this.value,b.redraw(z,b.utils.items.getItem(z.id))}.bind(u,x,v,w);u.addEventListener('click',y,!1),u.addEventListener('input',y,!1),u.addEventListener('focus',y,!1),u[n].eventOnFocus=1}}function h(u){return u&&~['INPUT','SELECT','TEXTAREA'].indexOf(u.tagName)}function j(u){for(var v in u)if(h(u[v]))return u[v];return!1}var l={},n=b.MAGNUM,o=function(u,v){for(var w=1;w<u.length;w++){var x=u[w],y=u[w+1],z=b.fill.find(Array.isArray(v)?v[0]:v,x);if(y&&!isNaN(+y))v=z[y];else if(z&&z.length&&y&&w+2<u.length)v=b.fill.find(z[0],y);else if(z&&z.length&&(v=z,w+2==u.length))break}return Array.isArray(v)?v[0]:v},q=function(u,v,w,x){var z,y=w.toString().split('.');if(3<=y.length)x=o(y,x),z=b.fill.find(x,v);else{var A=parseInt(y.pop()),B=isNaN(A)?0:A;z=b.fill.find(x[B]?x[B]:x,v)}return f(z,u,v,x)},r=function(u,v,w,x){var y=w[v];~['_value','_checked','_text'].indexOf(v)&&'string'==typeof u&&(v=u.split('.').pop());var z=b.fill.find(x,v),A=j(z);if('function'!=typeof y&&A){var B=q.bind({},w,v,u,x);B(),Object.defineProperty(w,v,{configurable:!0,get:function(){var C=B();return C&&'undefined'!==C.value&&C[n]&&C[n].dirty&&C.value!==y?(y=C.value,b.redraw(x,u,1),C.value):y},set:function(C){var D=B();D&&'undefined'!==D.value&&D.value!==C&&C!==y&&(D.value=C,y=C)}})}},t=function(u,v,w){for(var x in v)if(v.hasOwnProperty(x)){var y=v[x];'object'!=typeof y||b.utils.isHTMLEle(y)?r.bind({},u,x,v,w)():(b.utils.isObject(y)&&b.utils.isEmpty(y)&&(y._value=''),t(u+'.'+x,y,w))}};l.attachToArgs=t,b.props=l}(mag),function(b){'use strict';var c={};c.copy=n=>Object.assign({},n),c.merge=function(){return Object.assign.apply({},arguments)},c.extend=function(n,o,q){for(var r in o)if(o[r]===void 0)delete o[r];else if(q&&c.isObject(o[r]))return c.extend(n[r],o[r]);return c.merge(n,o)},c.isObject=n=>'Object]'==Object.prototype.toString.call(n).substr(-7);var f=(n,o)=>'function'==typeof o?''+o:o;c.toJsonString=n=>JSON.stringify(n,f),c.isEmpty=n=>{for(var o in n)if(n.hasOwnProperty(o))return 0;return 1},c.isHTMLEle=n=>n&&1===n.nodeType,c.callHook=function(n,o,q,r,t,u){n[q][r].key==o&&(u={v:t.value,k:t.key},t.change=!1,n[q][r].handler.call(n[q][r].context,t),{v:t.value,k:t.key}!==u&&(t.change=!0))};var g=[],h=[];c.scheduleFlush=function(n,o){return new Promise(function(q){b.rafBounce||b.rafBounceIds[n]?(cancelAnimationFrame(h[n]),h[n]=requestAnimationFrame(function(){o(),q(),h[n]=0})):(g.push(o),h[n]?q():h[n]=requestAnimationFrame(function(){h[n]=0;for(var r;r=g.shift();)r();q()}))})};var j=[];c.onLCEvent=function(n,o,q){var r=n+'-'+o;j[r]=j[r]||[];var t=j[r].push(q);return function(){return j[r].splice(t-1,1)}},c.callLCEvent=function(n,o,q,r,t,u){var v;c.runningEventInstance=r;var w=b.mod.getProps(r),x=b.mod.getMod(r);x[n]?(v=x[n].call(x,q,w,r,u),t&&(x[n]=0)):o&&o[n]&&(v=o[n].call(x,q,w,r,u),t&&(o[n]=0));var y=n+'-'+r;if(j[y]){for(var z of j[y])z(o,w);t&&(j[y]=0)}return(c.runningEventInstance=-1,!1===v)||void 0};var l={i:[],isItem:n=>~l.i.indexOf(n),setItem:n=>l.i[l.i.length]=n,getItem:n=>l.i.indexOf(n),getItemVal:n=>l.i[n],removeItem:n=>l.i.splice(l.i.indexOf(n),1)};c.items=l,c.getItemInstanceIdAll=()=>l.i,c.getItemInstanceId=n=>{return l.isItem(n)?l.getItem(n):(l.setItem(n),l.getItem(n))},b.utils=c}(mag),function(b,c,f){'use strict';function g($){return Array.isArray($)}function h($,_){return $[Q]=$[Q]||{},(!$[Q].uid||_)&&($[Q].uid=++X),$[Q].uid}function j($,_){var aa=h($,_);return U[aa]?U[aa]:U[aa]=o($)}function l($,_,aa){var ba=h($,aa);return V[O.id]=V[O.id]||[],V[O.id][ba]&&V[O.id][ba]==_?1:void(V[O.id][ba]=_)}function n($){return $.id?$:$.parentNode?n($.parentNode):void 0}function o($){var _='',aa=n($),ba=$.parentNode&&[].indexOf.call($.parentNode.children,$);return aa&&(_+='id("'+aa.id+'")'),_+='/'+$.tagName+'['+(ba+1)+']',_}function q($){if($.id&&O.id===$.id)return'id("'+$.id+'")';if($===b.doc.body)return $.tagName;var _=0;if($.parentNode)for(var ca,aa=$.parentNode.childNodes,ba=0;ba<aa.length;ba++){if(ca=aa[ba],ca===$)return q($.parentNode)+($.tagName?'/'+$.tagName+'['+(_+1)+']':'');1===ca.nodeType&&ca.tagName===$.tagName&&_++}}function r($){var _=q($);$&&P[_+'-config']&&P[_+'-config'].configContext&&typeof P[_+'-config'].configContext.onunload==='function'&&(P[_+'-config'].configContext.onunload(P[_+'-config'].configContext,$,_),delete P[_+'-config'],delete O.configs[_]),$.parentNode&&$.parentNode.removeChild($),b.mod.cached[b.utils.items.getItem(O.id)]=0}function t($){var _=$&&parseInt($.split('[').pop().slice(0,-1));return _?parseInt(_)-1:0}function u($){return $&&~$.indexOf('id(')&&$.split('id("')[1].split('")')[0]}function v($){if($&&$[Q]&&$[Q].isChildOfArray)return $;return $.parentNode?v($.parentNode):void 0}function w($,_,aa){if(!l($,_.outerHTML,aa)&&(!_.id&&!$.childNodes[0]||_.id&&!b.doc.getElementById(_.id)||$.firstChild&&!$.firstChild.isEqualNode(_))){var ba=b.utils.items.getItem(_.id);if(~ba&&$.hasChildNodes()){var ca=b.utils.items.getItem(O.id),da=$.cloneNode(1);da[Q]={childof:ca},b.mod.getProps(ba).children=da}else _[Q]&&_[Q].scid&&(da=$.cloneNode(1),da[Q]={childof:_[Q].scid},b._cprops[_[Q].scid]=da);for(;$.lastChild;)$.removeChild($.lastChild);if(_[Q]&&_[Q].childof!==f){$.innerHTML=_.innerHTML;var ea=_[Q].childof;b._cprops[ea]||(x($,ea),b.utils.onLCEvent('willupdate',ea,()=>{x($,ea)}))}else $.appendChild(_)}}function x($,_){var aa=O.id;O.setId(b.mod.getId(_)),O.run($,b.mod.getState(_)),O.setId(aa)}function y($,_){var aa;for(var ba in _){var ca=_[ba];ca===f?ca='':null===ca&&-1===['onunload'].indexOf(ba)?($[Q].detached=$[Q].detached||[],$[Q].detached[ba]=1,C($,ba)):$[Q].detached&&$[Q].detached[ba]&&(B($,ba),$[Q].detached[ba]=0),'_'===ba[0]&&'_'!==ba[1]&&(aa=aa||{},aa[ba.substr(1)]=ca)}return aa}function z($,_,aa){var ba;for(var ca in _){var da=_[ca];if(!~O.ignorekeys.indexOf(ca)&&'_'!==ca[0]){ba=K($,ca);var ea={key:ca,value:da,node:$};b.hook('values','*',ea),ea.change&&(da=ea.value),O.run(ba,da,aa+'/'+ca)}}}function A($,_,aa,ba){var ca,ga=t(aa);return _&&b.utils.isHTMLEle(_)?void w($,_):'function'==typeof _?Y(_,$,ga,aa):'object'==typeof _?void(b.mod.innerMods[O.id]&&_[b.mod.innerMods[O.id][0]]&&!_[b.mod.innerMods[O.id][0]].draw&&b.mod.innerMods[O.id][1].destroy(),ca=y($,_),ca&&H($,ca,aa,ba),z($,_,aa)):A($,{_text:_},aa)}function B($,_){var aa=K($,_);aa.forEach(function(ba){var ca=h(ba);if(ca in Z){for(var da in Z[ca])ba.appendChild(Z[ca][da]);delete Z[ca]}})}function C($,_){var aa=0,ba=1,ca=function(fa){if(++aa==ba)for(;fa.lastChild;)r(fa.lastChild)},da=function(fa,ga){var ha;fa.id&&b.utils.items.isItem(fa.id)&&(ha=b.utils.items.getItem(fa.id)),ha&&b.mod.getState(ha).onbeforeunload?(ba++,b.utils.callLCEvent('onbeforeunload',b.mod.getState(ha),fa,ha,0,function(){ha&&b.utils.callLCEvent('onunload',b.mod.getState(ha),fa,ha),ga()})):(ha&&b.utils.callLCEvent('onunload',b.mod.getState(ha),fa,ha),ga())},ea=K($,_);ea.forEach(function(fa){var ga=h(fa);fa.children.length&&(Z[ga]=D(fa.children));for(var ia in Z[ga]){var ja=Z[ga][ia];da(ja,function(){ca(fa)})}ca(fa)})}function D($){var _;if(null==$.length&&($=[$]),!g($)){_=[];for(var aa=0;aa<$.length;aa+=1)$[aa]&&_.push($[aa]);$=_}return $}function E($,_){var aa=function(ba,ca,da){var ea=v(ca),fa=ea&&q(ea),ga=t(fa),ha=o(ca),ia=t(ha),ja={path:fa,node:ea,data:((ea||{})[Q]||[]).dataPass,index:ga},ka=u(ha),la=b.doc.getElementById(ka),ma=b.utils.items.getItem(ka),na=ba.call(~ma?b.mod.getMod(ma):la,da,ia,ca,ja);if(ka&&la){var oa=function(){b.redraw(la,ma,1)};na&&na.then?na.then(function(pa){return oa(),pa}):oa()}return na}.bind({},_,$);return aa}function F($,_){function aa(ba){var ca=$[Q].eventHandlers[_];for(var da in ca){var ea=ca[da],fa=E($,ea),ga=fa(ba);!1===ga&&ba.preventDefault()}}$.removeEventListener(_,aa),$.addEventListener(_,aa)}function G($,_,aa,ba){var ca=_.substr(2).toLowerCase(),da=(ba?ba.split(')').pop():'')+'-'+aa[Q].uid,ea=aa[Q].events=aa[Q].events||[],fa=aa[Q].eventHandlers=aa[Q].eventHandlers||[];fa[ca]=fa[ca]||[],fa[ca][da]=$,ea[ca]||(ea[ca]=1,F(aa,ca))}function H($,_,aa,ba){var ca=t(aa);for(var da in P[h($)]=P[h($)]||[],_)if('text'!==da&&'html'!==da)if(0==da.indexOf('on'))G(_[da],da,$,ba);else{if('config'==da){var aa=q($),ca=t(aa),ea=!0;P[aa+'-config']?ea=!1:P[aa+'-config']={};var fa=P[aa+'-config'].configContext=P[aa+'-config'].configContext||{},ga=function(ka,la){return function(){return ka.apply(ka,la)}};c[aa]=ga(_[da],[$,ea,fa,ca]);continue}var ha={key:da,value:_[da],node:$};if(b.hook('attributes',da,ha),ha.change&&(da=ha.key,_[da]=ha.value),P[h($)]&&P[h($)][da]==_[da])continue;null===_[da]?$.removeAttribute(da):da in $?'style'==da?$[da].cssText=_[da]:$[da]=_[da]:$.setAttribute(da,_[da]+''),P[h($)][da]=_[da]}I($,_.text),J($,_.html)}function I($,_){if($&&null!=_&&!l($,_)){var aa=_+'';if('INPUT'!==$.nodeName)'SELECT'!==$.nodeName&&($.firstChild?$.firstChild.textContent=aa:$.appendChild($.ownerDocument.createTextNode(aa)));else if(!~['radio','checkbox'].indexOf($.type))aa!=$.value&&($.value=aa);else if($.name){var ba=b.getNode(O.id).querySelectorAll('[name='+$.name+']');if(1<ba.length)for(var ca of ba)if(ca.value==aa){ca.checked=!0;break}}'SELECT'===$.nodeName&&aa&&($.value=aa)}}function J($,_){!$||null==_||l($,_)||($.innerHTML=b.utils.isHTMLEle(_)?_.innerHTML:_)}function K($,_,aa){var ba=M($),ca=[],da=_,ea='$'===_[0];'$'===da[0]&&(da=da.substr(1));for(var fa=0;fa<ba.length;fa+=1)N(ba[fa],da)&&ca.push(ba[fa]);if(!ca.length||ea)for(var fa=0;fa<ba.length&&(ca=ca.concat(K(ba[fa],_,!0)),!ca.length||ea);fa++);if(!aa&&!ca.length){var ga={key:_,value:ca,node:$};b.hook('elementMatcher',_,ga),ga.change&&(ca=ga.value)}return ca}function L($){return O.id&&(b.utils.isHTMLEle(O.id)&&$[Q]&&$[Q].scid||$.id&&$.id!=O.id&&b.utils.items.isItem($.id))?0:1}function M($){var _=[];if($){var aa=$.childNodes;if(aa)for(var ba=0;ba<aa.length;ba+=1)1===aa[ba].nodeType&&L(aa[ba])&&_.push(aa[ba])}return _}function N($,_){var aa=' '+$.className+' ';return $.id===_||~aa.indexOf(' '+_+' ')||$.name===_||$.nodeName.toLowerCase()===_.toLowerCase()||$.getAttribute('data-bind')===_}var O={cached:[],ignorekeys:['toString','draw','then','hasOwnProperty','willgetprops','onbeforeunload','Symbol(Symbol.toStringTag)','nodeType','toJSON','onunload','willupdate','didupdate','didload','willload','isupdate']},P=O.cached,Q=b.MAGNUM,S='undefined',T='_key',U=[],V=[],W={},X=0;O.run=function($,_,aa){var ba,ca;if($){null==_&&(_={_text:''});var da=D($);if(ca=g(_),ca){if(W[aa]&&0===da.length&&(W[aa].parent.insertAdjacentHTML('beforeend',W[aa].node),da=D(W[aa].parent.children)),!da.length)return;var ea=da[0].parentNode;for(W[aa]||(W[aa]={node:da[0].cloneNode(1).outerHTML,parent:ea});da.length<_.length;)W[aa]?(ea.insertAdjacentHTML('beforeend',W[aa].node),ba=ea.lastChild):ba=da[0].cloneNode(1),da.push(ba),ea&&ea.appendChild(ba);var fa=_.map(function(ka){return ka&&ka[T]});if((da.length==_.length||-1!==fa.indexOf(f))&&(_=_.map(function(ka,la){if('object'==typeof ka){if(da[la][Q]=da[la][Q]||{},da[la][Q].__key&&typeof ka[T]==S)return ka[T]=da[la][Q].__key,ka;typeof ka[T]==S&&(ka[T]=Q+la),da[la][Q].__key=ka[T]}return ka})),da.length>_.length)if(0===_.length||'object'!=typeof _[0])for(;da.length>_.length;)ba=da.pop(),ea=ba.parentNode,ea&&r(ba);else{var ga=[],ha=_.map(function(ka){return ka[T]});da=da.filter(function(ka){var ma;return(typeof ka[Q]==S?ma=1:(!~ha.indexOf(ka[Q].__key)||~ga.indexOf(ka[Q].__key))&&(ga.push(ka[Q].__key),ma=1),ma)?(r(ka),!1):(ga.push(ka[Q].__key),!0)})}}for(var ia=0;ia<da.length;ia++)if(ca)da[ia]&&O.run(da[ia],_[ia]);else{var ja=j(da[ia]);_&&'object'==typeof _&&_.hasOwnProperty(T)&&(da[ia][Q].isChildOfArray=!0,!b.utils.isHTMLEle(_)&&(da[ia][Q].dataPass=_)),da[ia][Q].xpath=ja,A(da[ia],_,ja,aa)}}};var Y=function($,_,aa,ba){var ca=v(_.parentNode),da=ca&&ca.getAttribute('key');ca&&da&&(aa=+da.split(Q)[1]);var ea=$(++aa,ba);if(ea&&b.utils.isHTMLEle(ea))w(_,ea),_[Q]=_[Q]||{},_[Q].isChildOfArray=!0,_[Q].dataPass={index:aa},$.draw&&$.draw();else{var fa=/<[a-z][\s\S]*>/i.test(ea)?'_html':'_text',ga={};return ga[fa]=ea,A(_,ga,ba)}},Z=[];O.removeNode=r,O.configs=c,O.find=K,O.setId=$=>{O.id=$},O.clearCache=$=>{V[$]&&delete V[$]},b.fill=O}(mag,[]),function(b){function f(h,j,l,n){function o(r){return q.has(r)}var q=new WeakSet;return new Proxy(h,{get:function(r,t,u){var v=r[t];if('symbol'==typeof t)return v;if('object'!=typeof v||'symbol'==typeof v||null===v||'function'==typeof v||Array.isArray(v)||!b.utils.isObject(v)||v.then||v.draw)t in r||~b.fill.ignorekeys.indexOf(t.toString())||l||'_'==t[0]||(v=b.proxy({},j,l,n+g+t));else if(!o(v))return q.add(v),b.proxy(v,j,l,n+g+t);var w=j({type:'get',object:r,name:t,path:n,oldValue:Reflect.get(r,t,u)});return'undefined'!=typeof w&&(v=w==b.MAGNUM?void 0:w),v},deleteProperty:function(r,t){return j({type:'delete',name:t,object:r,oldValue:Reflect.get(r,t)}),Reflect.deleteProperty(r,t)},set:function(r,t,u,v){var w=Reflect.get(r,t,v);return w===u&&'length'!==t||(j({type:'set',name:t,object:r,oldValue:w}),Reflect.set(r,t,u,v))}})}var g='/';b.proxy=function(h,j,l,n){for(var o in h){var q=typeof h[o];Array.isArray(h[o])&&101>h[o].length?h[o]=f(h[o],j):'object'==q&&null!==h[o]&&'symbol'!=typeof o&&'symbol'!=q&&'function'!=q&&b.utils.isObject(h[o])&&(h[o]=b.proxy(h[o],j,l,n+g+o))}return f(h,j,l,n||g)}}(mag,window||global||this);
